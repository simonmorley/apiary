FORMAT: 1A
HOST: https://api.polkaspots.com

# PolkaSpots API Documentation for Cucumber Tony (Beta).

##I'm doing it with Cucumber Tony's API, are you?##

Cucumber Tony's API provides a way to control your Wireless networks programatically. This documentation is not considered production ready.

Our API is based on REST principles, all you need to use it is your Cucumber Tony account. You must be authenticated and call HTTPs requests on the URLs listed below. 

Please create an application in Cucumber Tony and use your access token in all requests. More documentation will follow.

The API uses secure Oauth2 to authenicate. You need to create an application before you can use the end-points.

>**Note:** Some resources trigger updates to your boxes. Sending invalid data can cause your boxes to crash.

## Generally Allowed HTTPs requests:

- `POST` - Creates or updates a resource
- `PATCH` - Updates a resource
- `GET` - Retrieves a resource or list of resources
- `DELETE` - Delete a resource

##Typical Server Responses

- 200 `OK` - The request was successful (some API calls may return 201 instead).
- 201 `Created` - The request was successful and a resource was created.
- 204 `No Content` - The request was successful but there is no representation to return (that is, the response is empty).
- 401 `Unauthorized` - Authentication failed or user does not have permissions for the requested operation.
- 403 `Forbidden` - Access denied. Naughty pants.
- 404 `Not Found` - Resource was not found.
- 405 `Method Not Allowed` - Requested method is not supported for the specified resource.
- 422 `Bad Request` - The request could not be understood or was missing required parameters.
- 429 `Too Many Requests` - Exceeded our API limits of 60 per minute. 
- 503 `Service Unavailable` - The service is temporary unavailable. Try again later.

##Oauth2 

To make use of the Cucumber Tony API, you will need an access token (and refresh token if building a more persistent application).

For more information how to generate this, create an application here:

https://mywifi.polkaspots.com/oauth/applications

SSL is required.

# Group Boxes

Boxes belong to locations and whilst you can read, update, destroy and perform other non-restful actions on a box (or boxes), you are not permitted to create a box without specifiying a location_id with the parameters.

For information about upgrading the software on your devices, please use the payloads API.

##Allowed HTTPs requests:

- `POST` - Creates or updates a resource
- `PATCH` - Updates a resource
- `GET` - Retrieves a resource or list of resources
- `DELETE` - Delete a resource

## Boxes Collection [/api/v1/boxes]

Lists all your boxes globally.

### List all Boxes [GET]

+ Response 200 (application/json)


    + Body

            [
                {
                    "nasname": "10.85.10.162",
                    "slug": "JCyK7Zwh0ON_ZOWso8Mhuw",
                    "calledstationid": "DC-9F-DB-3D-AC-49",
                    "last_heartbeat": "August 21 2014 01:12:07",
                    "label_name": "success",
                    "location_id": 53,
                    "machine_type": "Ubiquiti AirRouter",
                    "location_name": "PS Bavan Testing AirRouter",
                    "description": "PS Bavan Testing AirRouter 2",
                    "state": "Online",
                    "can_reboot": true,
                    "rebooted": true,
                    "connected_clients_size": 0
                },
                {
                    "nasname": "10.85.13.238",
                    "slug": "bzwZif_WftBTFkPDfjfJfA",
                    "calledstationid": "24-A4-3C-7C-FC-0A",
                    "last_heartbeat": "August 21 2014 01:12:07",
                    "label_name": "success",
                    "location_id": 53,
                    "machine_type": "Ubiquiti UniFi",
                    "location_name": "PS Bavan Testing AirRouter",
                    "description": "PS Bavan Testing AirRouter 4",
                    "state": "Online",
                    "can_reboot": true,
                    "connected_clients_size": 0
                },
                {
                    "nasname": "2.5.6.7",
                    "slug": "BFU1ZP9QeN0k3NSIIz8UQQ",
                    "calledstationid": "00-27-22-50-5C-E1",
                    "last_heartbeat": "August 21 2014 01:12:07",
                    "label_name": "success",
                    "location_id": 53,
                    "machine_type": null,
                    "location_name": "PS Bavan Testing AirRouter",
                    "description": "PS Bavan Testing AirRouter 5",
                    "state": "Online",
                    "can_reboot": false,
                    "connected_clients_size": 5
                },
                {
                    "nasname": "10.85.18.146",
                    "slug": "fUMJ89X6s4MM1AajUHl-fQ",
                    "calledstationid": "24-A4-3C-02-37-67",
                    "last_heartbeat": "August 21 2014 01:12:07",
                    "label_name": "success",
                    "location_id": 53,
                    "machine_type": "Ubiquiti UniFi AP Pro",
                    "location_name": "PS Bavan Testing AirRouter",
                    "description": "PS Bavan Testing AirRouter 5",
                    "state": "Online",
                    "can_reboot": true,
                    "connected_clients_size": 0
               }
            ]

## Location Boxes Collection [/api/v1/locations/{location_id}/boxes]

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.

### List all Location Boxes [GET]

+ Request (application/json)

            { "location_id": "derby-council" }

+ Response 200 (application/json)


    + Body

            {
                "stats": {
                    "total": null
                },
                "boxes": [
                    {
                        "id": 3184,
                        "nasname": "6.2.5.0",
                        "slug": "xxxx-nusg4jvflp4g",
                        "calledstationid": "CC-10-8A-13-52-A0",
                        "location_id": 2586,
                        "machine_type": null,
                        "is_polkaspots": true,
                        "label_name": "default",
                        "description": "Le Gaff 8 - Ruckus",
                        "avg_speedtest": null,
                        "human_state": "New",
                        "state": "new",
                        "can_reboot": false,
                        "device_icon": "blank.png",
                        "clients_online": 0,
                        "firmware_version": null,
                        "gubbins_version": null,
                        "uptime": null
                    },
                    {
                        "id": 3183,
                        "nasname": "4.1.7.6",
                        "slug": "xxxxx_2nru_oc6plfg",
                        "calledstationid": "xx-xx-72-C6-3C-E8",
                        "location_id": 2586,
                        "machine_type": null,
                        "is_polkaspots": false,
                        "label_name": "default",
                        "description": "Aruba",
                        "avg_speedtest": null,
                        "human_state": "New",
                        "state": "new",
                        "can_reboot": false,
                        "device_icon": "blank.png",
                        "clients_online": 0,
                        "firmware_version": null,
                        "gubbins_version": null,
                        "uptime": null
                    },
                    {
                        "id": 3179,
                        "nasname": "3.6.7.3",
                        "slug": "xxxxirvamw1hdyhhfga",
                        "calledstationid": "xx-xx-7D-20-0E-87",
                        "location_id": 2586,
                        "machine_type": null,
                        "is_polkaspots": true,
                        "label_name": "default",
                        "description": "Le Gaff 6",
                        "avg_speedtest": null,
                        "human_state": "New",
                        "state": "new",
                        "can_reboot": false,
                        "device_icon": "blank.png",
                        "clients_online": 0,
                        "firmware_version": null,
                        "gubbins_version": null,
                        "uptime": null
                    },
                    {
                        "id": 3187,
                        "nasname": "10.80.21.198",
                        "slug": "xxxdtiebgf08dcsy-sbw",
                        "calledstationid": "xx-xx-3C-02-37-26",
                        "last_heartbeat": 1425064690,
                        "location_id": 2586,
                        "machine_type": "Ubiquiti UniFi AP Pro",
                        "is_polkaspots": true,
                        "label_name": "danger",
                        "description": "Le Gaff 9",
                        "avg_speedtest": null,
                        "human_state": "Offline",
                        "state": "offline",
                        "can_reboot": false,
                        "device_icon": "ubiquiti-unifi-ap-pro-icon.png",
                        "clients_online": 1,
                        "firmware_version": "p_141203_00",
                        "gubbins_version": "1.3.5",
                        "uptime": " 19:18:06 up  3:08,  load average: 0.41, 0.33, 0.29, 11301.43"
                    }
                ],
                "_links": {
                    "current_page": 1,
                    "total_pages": 1,
                    "next_page": null,
                    "total_entries": 8
                }
            }

## Box [/api/v1/boxes/{id}]

The box object contains a lot of information relating to both the box and the local networks. Assuming the box is online, you will see a nested object called iwinfo which contains the interface stats, including signal strength and SSID.

For more detailed iwinfo / wireless stats, please use the Interfaces API.

Some of the information will seem irrelevant however we have included all fields required to fully troubleshoot and diagnose. For example, gubbins_version relates to the software version you're currently using.

There's some helpers included too which may help you build a beautiful portal. We've included a humanised device_icon field, status colour and a few more goodies.

+ Parameters

    + id (required, string, `a-long-slug`) ... Slug `slug` of the box to perform action with. Has example value.

### Display a box [GET]

+ Request (application/json)

            { "id": "JCyK7Zwh0ON_ZOWso8Mhuw" }

+ Response 200 (application/json)

    + Body

            {
                "slug": "YZJ6exYhemVwrOfigb-x1w",
                "created_at": 1404910675,
                "device_icon": "ubiquiti-unifi-ap-pro-icon.png",
                "uptime": " 11:34:04 up 12:57,  load average: 0.13, 0.11, 0.14, 46648.23",
                "location_id": 590,
                "gmaps_zoom": 17,
                "last_heartbeat": 1425209644,
                "description": "Polkaspots Office BOX 2",
                "calledstationid": "xx-xx-3C-02-37-67",
                "wan_ip": "10.0.1.250",
                "wan_proto": "dhcp",
                "public_ip": "33.33.199.193",
                "dns_hostname": "33-33-199-193.static.ps.net",
                "state": "online",
                "installer_id": 4,
                "serial_number": "5664-8359-6940-8594",
                "system_type": "Atheros AR9344",
                "machine_type": "Ubiquiti UniFi AP Pro",
                "access_token": "cfe433b0-315c-41e1-972e-73d9652aa6eb",
                "latitude": "51.5221223564181",
                "longitude": "-0.104187726974487",
                "wan_ipaddr": null,
                "wan_netmask": "255.255.255.0",
                "wan_gateway": null,
                "wan_dns_1": "8.8.8.8",
                "wan_dns_2": "8.8.4.4",
                "channel": "auto",
                "channel_5": "auto",
                "tx_power_2": "20",
                "tx_power_5": "20",
                "ht_mode_2": "HT20",
                "ht_mode_5": "HT20",
                "updated_at": 1425209654,
                "development_mode": "Beta",
                "is_monitored": true,
                "pppoe_username": null,
                "pppoe_password": null,
                "radiusnasid": "XXX-eb38-48ed-99d3-6c3e6e",
                "last_disconnect_reason": "power",
                "firmware_version": "B_140812_00",
                "next_firmware": null,
                "upgrade_scheduled": null,
                "upgrade_processing": false,
                "dual_band": true,
                "iwinfo": [
                    {
                        "ssid": "Office-PBP",
                        "interface": "wlan0",
                        "noise": -95,
                        "channel": 36
                    },
                    {
                        "ssid": "Will Young and Rod Stewart",
                        "interface": "wlan0-1",
                        "noise": -95,
                        "channel": 36
                    },
                    {
                        "ssid": "Office-PBP",
                        "interface": "wlan1",
                        "noise": -95,
                        "channel": 11
                    },
                    {
                        "ssid": "Will Young and Rod Stewart",
                        "interface": "wlan1-1",
                        "noise": -95,
                        "channel": 11
                    }
                ],
                "avg_speedtest": 1976458,
                "wan_mtu": 1492,
                "speedtest_running": false,
                "status_colour": "#64AB35",
                "upgrading": false,
                "can_reboot": true,
                "latest_speedtest": {
                    "result": 1365,
                    "timestamp": 1425182795
                },
                "is_online": true,
                "is_polkaspots": true,
                "clients_online": "0",
                "timezone": "London",
                "auto_upgrades": false,
                "sockets_hash": "YZJ6eYhemVwrOfigb-x1w",
                "band_steering": true,
                "radius_secret": "secret-passy",
                "sync_id": "0e38ccc6e2b73cc65f14fa3d053385282639",
                "certs": true,
                "gubbins_version": "1.3.5"
            }

### Delete a box [DELETE]

+ Parameters

    + id (required, integer, `1`) ... ID of the box you wish to delete.

+ Request (application/json)

        {   "id": 'JCyK7Zwh0ON_ZOWso8Mhuw'  }

+ Response 204 (application/json)


## Box Create [/api/v1/boxes{?calledstationid,description,location_id,discovery}]

### Create a Box [POST]

Don't forget, you must send the location_id with your request IN the box params. The following params are available:

If you are using the magic auto-discovery tool, please use the detect API end point before creating a box. Passing the parameter discovery=true will automatically add your discovered devices. If you're using this method, you do not need to send the calledstationid etc.
+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + calledstationid (required, string, `mac`) ... Mac address of the box.
    + description (required, text, `Upstairs, in the loft`) ... A description of the box.
    + discovery (optional, boolean, `true`) ... Send this parameter in to override the above options and automatically add discovered boxes.

+ Request (application/json)

        { 
            "box":
                {
                    "location_id": 53,
                    "gmaps_zoom": 10,
                    "description": "In the washing room",
                    "calledstationid": "DC-9F-DB-3D-AC-49",
                    "wan_ip": "192.168.1.64",
                    "wan_proto": "static",
                    "radius_secret": "f797ef11f80f2737e07de1bae056",
                    "access_token": "3db9e053-fabb-422d-a5b1-18b275af5236",
                    "machine_type": "Ubiquiti AirRouter",
                    "gubbins_version": "1.3",
                    "latitude": "51.54462696721446",
                    "longitude": "-0.053558349609375",
                    "wan_netmask": "255.255.255.0",
                    "wan_gateway": "192.168.1.1",
                    "wan_dns_1": "8.8.8.8",
                    "wan_dns_2": "8.8.4.4",
                    "channel": "04",
                    "channel_5": "auto",
                    "tx_power_2": "19",
                    "tx_power_5": "20",
                    "ht_mode_2": "HT40+",
                    "ht_mode_5": "HT20",
                    "updated_at": "September 29 2014 17:13:56",
                    "development_mode": "Beta",
                    "is_monitored": false,
                    "pppoe_username": "user@polkaspots.com",
                    "pppoe_password": "pass"
                }
        }
        

+ Response 200 (application/json)

                {
                    "slug": "JCyK7Zwh0ON_ZOWso8Mhuw",
                    "created_at": "March 29 2014 10:54:59",
                    "device_icon": "ubiquiti-airrouter-icon.png",
                    "location_id": 53,
                    "gmaps_zoom": 10,
                    "description": "In the washing room",
                    "calledstationid": "DC-9F-DB-3D-AC-49",
                    "wan_ip": "192.168.1.64",
                    "wan_proto": "static",
                    "radius_secret": "f797ef11f80f2737e07de1bae056",
                    "access_token": "3db9e053-fabb-422d-a5b1-18b275af5236",
                    "machine_type": "Ubiquiti AirRouter",
                    "gubbins_version": "1.3",
                    "latitude": "51.54462696721446",
                    "longitude": "-0.053558349609375",
                    "wan_netmask": "255.255.255.0",
                    "wan_gateway": "192.168.1.1",
                    "wan_dns_1": "8.8.8.8",
                    "wan_dns_2": "8.8.4.4",
                    "channel": "04",
                    "channel_5": "auto",
                    "tx_power_2": "19",
                    "tx_power_5": "20",
                    "ht_mode_2": "HT40+",
                    "ht_mode_5": "HT20",
                    "updated_at": "September 29 2014 17:13:56",
                    "development_mode": "Beta",
                    "is_monitored": false,
                    "pppoe_username": "user@polkaspots.com",
                    "pppoe_password": "pass"
                }


## Update a box [/api/v1/boxes/{id}{?params}]

### Update a box [PATCH]

If you update any fields related to the network settings, you will reboot your boxes. These include:

- WAN_IP
- WAN_GATEWAY
- WAN_DNS_1
- WAN_DNS_2
- WAN_NETMASH
- BAND_STEERING
- CHANNEL_2
- CHANNEL_5
- PPOE_USERNAME

For a full list of available params, please see the box#show section above. Some fields are read-only and will be ignored. These might include things like the last_heartbeat.

+ Parameters

    + id (required, integer, `1`) ... ID of the blacklisted device you wish to update.
    + params (required, object, `1`) ... Any information about the box. A full list of params can be seen above.

+ Request (application/json)

        { 
            "box":
                {
                    "gmaps_zoom": 10,
                    "description": "In the washing room",
                    "calledstationid": "DC-9F-DB-3D-AC-49",
                    "wan_ip": "192.168.1.64",
                    "wan_proto": "static",
                    "radius_secret": "f797ef11f80f2737e07de1bae056",
                    "access_token": "3db9e053-fabb-422d-a5b1-18b275af5236",
                    "machine_type": "Ubiquiti AirRouter",
                    "gubbins_version": "1.3",
                    "latitude": "51.54462696721446",
                    "longitude": "-0.053558349609375",
                    "wan_netmask": "255.255.255.0",
                    "wan_gateway": "192.168.1.1",
                    "wan_dns_1": "8.8.8.8",
                    "wan_dns_2": "8.8.4.4",
                    "channel": "04",
                    "channel_5": "auto",
                    "tx_power_2": "19",
                    "tx_power_5": "20",
                    "ht_mode_2": "HT40+",
                    "ht_mode_5": "HT20",
                    "updated_at": "September 29 2014 17:13:56",
                    "development_mode": "Beta",
                    "is_monitored": false,
                    "pppoe_username": "user@polkaspots.com",
                    "pppoe_password": "pass"
                }
        }

+ Response 200 (application/json)

                {
                    "slug": "JCyK7Zwh0ON_ZOWso8Mhuw",
                    "created_at": "March 29 2014 10:54:59",
                    "device_icon": "ubiquiti-airrouter-icon.png",
                    "location_id": 53,
                    "gmaps_zoom": 10,
                    "description": "In the washing room",
                    "calledstationid": "DC-9F-DB-3D-AC-49",
                    "wan_ip": "192.168.1.64",
                    "wan_proto": "static",
                    "radius_secret": "f797ef11f80f2737e07de1bae056",
                    "access_token": "3db9e053-fabb-422d-a5b1-18b275af5236",
                    "machine_type": "Ubiquiti AirRouter",
                    "gubbins_version": "1.3",
                    "latitude": "51.54462696721446",
                    "longitude": "-0.053558349609375",
                    "wan_netmask": "255.255.255.0",
                    "wan_gateway": "192.168.1.1",
                    "wan_dns_1": "8.8.8.8",
                    "wan_dns_2": "8.8.4.4",
                    "channel": "04",
                    "channel_5": "auto",
                    "tx_power_2": "19",
                    "tx_power_5": "20",
                    "ht_mode_2": "HT40+",
                    "ht_mode_5": "HT20",
                    "updated_at": "September 29 2014 17:13:56",
                    "development_mode": "Beta",
                    "is_monitored": false,
                    "pppoe_username": "user@polkaspots.com",
                    "pppoe_password": "pass"
                }

## Reboot a box [/api/v1/boxes/{id}/reboot]

### Reboot a box [POST]

+ Parameters

    + id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... ID (we use the slug) of the device you want to reboot.

+ Request (application/json)

        { "id": "JCyK7Zwh0ON_ZOWso8Mhuw" }

+ Response 200 (application/json)

        { response: "Please allow 2-3 minute for the device to reboot" }

+ Response 400 (application/json)

        { status: "unprocessable_entity" }

## Reset a box [/api/v1/boxes/{id}/reset{?soft}]

Restores things to factory defaults.

Sending the parameter 'soft', will perform a soft reset of the box. This doesn't reset any certificates etc, it just resets the basic attributes.

### Reset a box [POST]

+ Parameters

    + id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... ID (we use the slug) of the device you want to reboot.
    + soft (optional, string, `true`) ... Soft reset the box by sending the soft=true parameter.

+ Request (application/json)

        { "id": "JCyK7Zwh0ON_ZOWso8Mhuw" }

+ Response 200 (application/json)

        { response: "Please allow 2-3 minute for the device to reset" }

+ Response 400 (application/json)

        { status: "unprocessable_entity" }

## Resync a box [/api/v1/boxes/{id}/resync]

This will cause a full configuration sync of the box sending the networks and wireless configuration files. This will restart all services and can disconnect users.

### Resync a box [POST]

+ Parameters

    + id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... ID (we use the slug) of the device you want to reboot.

+ Request (application/json)

        { "id": "JCyK7Zwh0ON_ZOWso8Mhuw" }

+ Response 200 (application/json)

        { response: "Please allow 2-3 minute for the device to resync" }

+ Response 400 (application/json)

        { status: "unprocessable_entity" }

## Transfer a box [/api/v1/boxes/{id}/transfer{?transfer_to}]

Creates a transfer to move a box to a different location. Please note, this cannot be reversed, if you enter the incorrect location_id to transfer to, you may lose the box forever :(

This does not happen immediately and will be queued for transfer. This might take a few seconds to complete.

Please note, this will also reset your box to reflect the settings of the new location.

### Transfer a box [POST]

+ Parameters

    + id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... ID (we use the slug) of the device you want to reboot.
    + transfer_to (required, string, `759275635389093876`) ... The Unique ID of the location you want to transfer the device to.

+ Request (application/json)

        { 
            "id": "JCyK7Zwh0ON_ZOWso8Mhuw",
            "transfer_to": "759275635389093876",
        }

+ Response 200 (application/json)

        { slug: "JCyK7Zwh0ON_ZOWso8Mhuw" }

+ Response 400 (application/json)

        { status: "unprocessable_entity" }

## Detect new boxes [/api/v1/boxes/detect{?location_id}]

Cucumber can automatically detect boxes with Stinky Panda installed. Once you have detected a box, you can then automatically add the selected once to your location.

The API will also return an array of boxes which have already been added. This is useful in case a previously detected box was added to your locations.

Please note, you must be close to the boxes you want to detect and on the same network. If you want add a box to another location, you must use the standard box create API.

Once you have detected your boxes, you will start receiving emails whenever a new box is connected in that location. 

Read the box#create section of this documentation to discover how to add boxes.

### Detect boxes [POST]

+ Parameters

    + location_id (required, string, `759275635389093876`) ... The slug / ID of the location you want to detect and add boxes to.

+ Request (application/json)

        { 
            "location_id": "bobs-house"
        }

+ Response 200 (application/json)

        [
            {
                "type": "Ubiquiti AirRouter",
                "mac": "DC-9F-DB-3D-AA-43",
                "existing": true
            },
            {
                "type": "Ubiquiti Unifi",
                "mac": "DD-ED-1D-AA-EE-AA",
                "existing": false
            }
        ]
        
+ Response 400 (application/json)

        { status: "unprocessable_entity" }

## Box alerts [/api/v1/boxes/{box_id}/alerts{?alerts}]

You can selectively enable and disable alerts for a box which will prevent CT from sending you emails when an event occurs. Events include reboots, upgrades, resync and status alerts.

### Enable / Disable alerts for a box [PATCH]

+ Parameters

    + box_id (required, string, `"JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the box to perform action with. Has example value.
    + alerts (required, boolean, `"true`) ... True or false depending on whether you want alerts on or off.

+ Request (application/json)
    
        { "box_id": "JCyK7Zwh0ON_ZOWso8Mhuw" }

+ Response 200 (application/json)

        {
            "is_monitored": true,
            "slug": "JCyK7Zwh0ON_ZOWso8Mhuw"
        }

+ Response 422 (application/json)

        { status: "unprocessable_entity" }

## Box Heartbeats [/api/v1/boxes/{id}/heartbeats{?interval,distance}]

Returns a list of heartbeats for the box by minute. Please note, this end-point returns a lot of data and can sometimes be a little slow. Results are therefore cached and update every 10 minutes.

You can adjust the interval and distance too. The distance must be numeric and the interval can be one of the following:

minute, hour, day, week, month, year.

A value of 0 represents offline and a value of 1 represents an online box.

+ Parameters

    + id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the box to perform action with. Has example value.
    + interval (optional, string, `hour`) ... Filter the results by interval, see above for full details.
    + distance (optional, integer, `7`) ... How far back you want to get the results for.

### List all heartbeats for a box [GET]

+ Request (application/json)

            { "id": "JCyK7Zwh0ON_ZOWso8Mhuw" }

+ Response 200 (application/json)


    + Body
    
            {
                "heartbeats": {
                    "1425210780": 1,
                    "1425210720": 1,
                    "1425210660": 0,
                    "1425210600": 1,
                    "1425210540": 1,
                    "1425210480": 1,
                    "1425210420": 1,
                    "1425210360": 1,
                    "1425210300": 0,
                    "1425210240": 1,
                    "1425193440": 1,
                    "1425193380": 1,
                    "1425193320": 0,
                    "1425186840": 1,
                    "1425186780": 1,
                    "1425186720": 1
                }
            }

## Box History [/api/v1/boxes/{id}/versions]

Returns the changeset for a box including the username of the person who made the change and details of what happened.

+ Parameters

    + id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the box to perform action with. Has example value.

### List all versions for a box [GET]

+ Request (application/json)

            { "id": "JCyK7Zwh0ON_ZOWso8Mhuw" }

+ Response 200 (application/json)


    + Body
    
            [
                {
                    "id": 102754,
                    "event": "update",
                    "whodunnit": null,
                    "changeset": {
                        "location_id": [
                            119,
                            2586
                        ]
                    },
                    "created_at": 1424212334
                },
                {
                    "id": 102738,
                    "event": "update",
                    "whodunnit": null,
                    "changeset": {
                        "address": [
                            null,
                            "62 Britton Street, London"
                        ],
                        "description": [
                            null,
                            "Box's House 2"
                        ]
                    },
                    "created_at": 1424207213
                }
            ]

## Box Payloads [/api/v1/boxes/{id}/payloads]

Returns the payloads that have recently run on the box. You can set up a payload to run using the payloads api. Payloads can include linux commands, status requests etc. 

+ Parameters

    + id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the box to perform action with. Has example value.

### List all payloads for a box [GET]

+ Request (application/json)

            { "id": "JCyK7Zwh0ON_ZOWso8Mhuw" }

+ Response 200 (application/json)

    + Body
    
            [
                {
                    "created_at": 1424207333,
                    "body": "Some body of the payload here, truncated.",
                    "type": "dmesg",
                    "id": 2324,
            
                }
            ]

# Group Commands

Commands reference the **Commands API**. 

Commands are predefined templates of payloads which can be applied directly to a box. There's two types of events:

1. Available to schedule
2. PolkaSpots only

PolkaSpots only commands should not be run on non-ps boxes. For example, you cannot schedule a Xirrus to reboot using the paylods API.

However, you may disable the Xirrus login screens. PolkaSpots only commands are suitable for boxes running the Stinky Panda firmware only.

Only PolkaSpots staff are able to create, modify and delete commands at the moment.

You will run a command on a box using the payloads API.

Commands are just templates. Payloads are the way to run them.

##Allowed HTTPs requests:

- `GET` - Retrieves a resource or list of resources

##Allowed HTTPs requests for non-customers:

- `POST` - Creates or updates a resource
- `PATCH` - Updates a resource
- `DELETE` - Delete a resource

## Commands Collection [/api/v1/commands]

### List all Commands [GET]

+ Response 200 (application/json)

    + Body
                
            [
                {
                    "id": 34,
                    "unique_id": "9328ce1-c7c4-49a2-bee1-c2a2d6234a9d",
                    "payload_description": "Reboot my access point ",
                    "payload_name": "Reboot Access Points",
                    "payload_command": "/sbin/reboot",
                    "can_schedule": true,
                    "only_polkaspots": true
                },
                {
                    "id": 35,
                    "unique_id": "9328ce1-c7c4-49a2-bee1-c2a2d6234a9d",
                    "payload_description": "Disable My Login Screens",
                    "payload_name": "Disable Login Screens",
                    "payload_command": "",
                    "can_schedule": true,
                    "only_polkaspots": false
                },
                {
                    "id": 36,
                    "unique_id": "9328ce1-c7c4-49a2-bee1-c2a2d6234a9d",
                    "payload_description": "Enable My Login Screens",
                    "payload_name": "Enable Login Screens",
                    "payload_command": "",
                    "can_schedule": true,
                    "only_polkaspots": false
                },
                {
                    "id": 37,
                    "unique_id": "9328ce1-c7c4-49a2-bee1-c2a2d6234a9d",
                    "payload_description": "Disable my private Wi-Fi network completely",
                    "payload_name": "Disable Private Wi-Fi Network",
                    "payload_command": "",
                    "can_schedule": true,
                    "only_polkaspots": true
                },
                {
                    "id": 38,
                    "unique_id": "9328ce1-c7c4-49a2-bee1-c2a2d6234a9d",
                    "payload_description": "Enable my private Wi-Fi network",
                    "payload_name": "Enable Private Wi-Fi Network",
                    "payload_command": "",
                    "can_schedule": true,
                    "only_polkaspots": true
                },
                {
                    "id": 39,
                    "unique_id": "9328ce1-c7c4-49a2-bee1-c2a2d6234a9d",
                    "payload_description": "Hide my public Wi-Fi network",
                    "payload_name": "Hide Public Wi-Fi Network",
                    "payload_command": "",
                    "can_schedule": true,
                    "only_polkaspots": true
                },
                {
                    "id": 40,
                    "unique_id": "9328ce1-c7c4-49a2-bee1-c2a2d6234a9d",
                    "payload_description": "Show my public Wi-Fi network",
                    "payload_name": "Show Public Wi-Fi Network",
                    "payload_command": "",
                    "can_schedule": true,
                    "only_polkaspots": true
                },
                {
                    "id": 41,
                    "unique_id": "9328ce1-c7c4-49a2-bee1-c2a2d6234a9d",
                    "payload_description": "Disable all Wi-Fi networks",
                    "payload_name": "Wi-Fi Down Completely",
                    "payload_command": "",
                    "can_schedule": true,
                    "only_polkaspots": true
                },
                {
                    "id": 42,
                    "unique_id": "9328ce1-c7c4-49a2-bee1-c2a2d6234a9d",
                    "payload_description": "Enable all Wi-Fi networks",
                    "payload_name": "Wi-Fi Up Completely",
                    "payload_command": "",
                    "can_schedule": true,
                    "only_polkaspots": true
                }
            ]
            
## Commands Create [/api/v1/commands{?command}]

### Create a command [POST]

+ Request 200 (application/json)

            {
                "command": 
                    {
                        "payload_description": "Reboot my access point ",
                        "payload_name": "Reboot Access Points",
                        "payload_command": "/sbin/reboot",
                        "can_schedule": true,
                        "only_polkaspots": true
                    }
            }


+ Response 200 (application/json)

    + Body
        
            {
                "id": 34,
                "payload_description": "Reboot my access point ",
                "payload_name": "Reboot Access Points",
                "payload_command": "/sbin/reboot",
                "can_schedule": true,
                "only_polkaspots": true
            }
        

## Command Details [/api/v1/commands/:id]

### Update a Command [GET]


+ Parameters

    + id (required, integer, `1`) ... ID of the command you wish to update.

+ Request (application/json)

        {"id": 34}

+ Response 200 (application/json)

    + Body
        
            {
                "id": 34,
                "payload_description": "Reboot my access point ",
                "payload_name": "Reboot Access Points",
                "payload_command": "/sbin/reboot",
                "can_schedule": false,
                "only_polkaspots": true
            }
        
## Command Update [/api/v1/commands/:id{?command}]

### Update a Command [PATCH]

+ Parameters

    + id (required, integer, `1`) ... ID of the command you wish to update.
    + command (required, params, `{some: params, included: here}`) ... An object with the parameters you want to update.

+ Request (application/json)

        {
            "command": {
                "payload_description": "Reboot my access point ",
                "payload_name": "Reboot Access Points",
                "payload_command": "/sbin/reboot",
                "can_schedule": false,
                "only_polkaspots": true
            }
        }

+ Response 200 (application/json)

    + Body
        
            {
                "id": 34,
                "payload_description": "Reboot my access point ",
                "payload_name": "Reboot Access Points",
                "payload_command": "/sbin/reboot",
                "can_schedule": false,
                "only_polkaspots": true
            }
        

## Command Delete [/api/v1/commands/{id}]

### Delete a Command [DELETE]

+ Parameters

    + id (required, integer, `1`) ... ID of the command you wish to update.

+ Request (application/json)

        {   
            "id": 123,
        }

+ Response 204 (application/json)

# Group Clients

Clients related resources of the **Clients API**. Clients are devices that have connected to your wireless networks. They can be on any SSID, using the captive portal or not.

Clients, when nested in the box or location resources. When using the box resource, the list shows connected and disconnected clients for box. You can therefore get an overview of your clients and drill down per box. Clients are updated every minute and will include details on the client device and also data rates.

If you require, you can also pass a Box mac address or addresses with the request to filter by box.

There is also a signal warning boolean field which you can use to diagnose client problems. An SNR lower than 15 is considered problematic.

You may also send the standard filter parameters we use:

- Interval
- Distance
- Start
- End
- AP Mac

These filter parameters allow you to view clients over a pre-set period. 

For clients which are currently connected via the captive portal, you can also disconnect them using the same API. Details are found below.

**The clients API is only available for boxes which use the PolkaSpots Firmware.**

## List Location Clients [/api/v1/locations/{location_id}/clients{?distance,interval,ap_mac}]

List all clients that have visited you location. Includes the currently connected clients.

### List all connected clients [GET]

+ Parameters

    + location_id (required, string, `le-gaff-wifi`) ... Slug `slug` of the Location to perform action with. Has example value.
    + distance (required, integer, `30`) ... The distance with which you want to filter your results.
    + interval (required, string, `hour`) ... Filter interval - group your results in convenient categories.
    + ap_mac (required, string, `11:22:33:44:55:66`) ... Filter your results by mac of your boxes.

+ Response 200 (application/json)

    + Body

            {
                "info": {
                    "location_id": 2586,
                    "connected": 1,
                    "children": 2,
                    "last_updated": 1424995575
                },
                "clients": [
                    {
                        "id": "54eced7261695540ea0000",
                        "online": false,
                        "ip": "",
                        "snr_alert": false,
                        "ap_mac": "xx-xx-3C-02-37-26",
                        "authenticated": true,
                        "authorized": true,
                        "client_mac": "xx-xx-BD-9B-A3-45",
                        "created_at": 1424786669,
                        "updated_at": 1424788881,
                        "device_name": "",
                        "name": null,
                        "manufacturer": "HTC Corporation",
                        "snr": 67,
                        "ssid": "AND-PU",
                        "ssids": [
                            "AND-PU"
                        ],
                        "firstseen": 1424786645,
                        "lastseen": 1424788805,
                        "txbytes": 829660,
                        "rxbytes": 923485,
                        "slug": "7gsv8dtiebgf08dcsy-sbw",
                        "description": "Le Gaff 9",
                        "splash_connected": false,
                        "splash_status": "dnat",
                        "splash_session": "54ec84ad00000001",
                        "splash_username": null,
                        "splash_usernames": null,
                        "splash_in": 0,
                        "splash_out": 0
                    },
                    {
                        "id": "54efxx340726169119b4c0400",
                        "online": true,
                        "ip": "192.168.210.45",
                        "snr_alert": true,
                        "ap_mac": "xx-xx-3C-02-37-26",
                        "authenticated": true,
                        "authorized": true,
                        "client_mac": "xx-xx-40-59-D4-C5",
                        "created_at": 1424945984,
                        "updated_at": 1424995575,
                        "device_name": "iPhone",
                        "name": null,
                        "manufacturer": "Apple",
                        "snr": 11,
                        "ssid": "AND-PR",
                        "ssids": [
                            "AND-PR"
                        ],
                        "firstseen": 1424945946,
                        "lastseen": 1424972345,
                        "txbytes": 582678185,
                        "rxbytes": 531322605,
                        "slug": "7gsvdtiebgf08dcsy-sbw",
                        "description": "Le Gaff 9",
                        "splash_connected": false,
                        "splash_status": null,
                        "splash_session": null,
                        "splash_username": null,
                        "splash_usernames": null,
                        "splash_in": 0,
                        "splash_out": 0
                    }
                ],
                "unique_aps": [
                    {
                        "ap_mac": "xx-A4-3C-02-37-26",
                        "description": "Le Gaff 9 "
                    }
                ]
            }

## Client Object [/api/v1/locations/{location_id}/clients/{id}]

View and manage individual clients. You can currently only update the name and notes.

Any data transmission rates are in bytes.

### Viewing a specific client [GET]

+ Parameters

    + location_id (required, string, `le-gaff-wifi`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, string, `id-123`) ... Id of the client you want to view. Has example value.

+ Response 200 (application/json)

    + Body

            {
                "id": "54eef340726169119b4c0400",
                "online": true,
                "ap_mac": "xx-A4-3C-02-37-xx",
                "ip": "192.168.210.45",
                "authenticated": true,
                "authorized": true,
                "capabilities": "5Ghz",
                "channel": 36,
                "client_mac": "xx-xx-40-59-D4-xx",
                "ap_description": "Le Gaff 9",
                "slug": "7xx8dtiebgf08dcsy-sbw",
                "device_name": "iPhone",
                "notes": null,
                "labels": "red",
                "name": null,
                "firstseen": 1424945946,
                "lastseen": 1424972345,
                "inactivetime": "229220ms",
                "interface": "wlan0-1",
                "location_id": 2586,
                "manufacturer": "Apple",
                "noise": -95,
                "signal": "-84",
                "signalavg": "-83",
                "snr": 11,
                "snr_alert": true,
                "splash_connected": false,
                "splash_status": null,
                "splash_username": null,
                "splash_usernames": null,
                "splash_session": null,
                "splash_in": 0,
                "splash_out": 0,
                "ssid": "AND-PR",
                "ssids": [
                    "AND-PR"
                ],
                "txbps": 96,
                "txbitrate": "7.2MBit/s",
                "rxbitrate": "24.0MBit/s",
                "txbytes": 582678185,
                "rxbytes": 531322605,
                "txbytes_session": 27452,
                "rxbytes_session": 29336,
                "txfailed": 1152,
                "txpackets": 1170831,
                "rxpackets": 2200936,
                "updated_at": 1424995575
            }

### Updating a specific client [PATCH]

+ Parameters

    + location_id (required, string, `le-gaff-wifi`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, string, `id-123`) ... Id of the client you want to view. Has example value.

+ Request (application/json)

        {   
            "id": 54eef340726169119b4c0400,
            client: {
                name: 'Simon',
                notes: 'Is here a lot these days'
            
            }
        }

+ Response 200 (application/json)
        
        client: {

        }

## Disconnect a Client [/api/v1/locations/{location_id}/clients/{id}/logout]

This will immediately disconnect the user from the hotspot, assuming they are actually logged in. You can also disconnect the client using the boxes resource. 

### Disconnect a specific client [POST]

+ Parameters

    + location_id (required, string, `le-gaff-wifi`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, string, `id-123`) ... Id of the client you want to view. Has example value.

+ Response 200 (application/json)

    + Body
    
            { 
                message: 'Client has been disconnected'
            }

## List Box Clients [/api/v1/boxes/{box_id}/clients]

List all clients on a specific box. Uses similar format to the location resource but restricts the results to an individual box.

### List all connected clients [GET]

+ Parameters

    + box_id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the Box to perform action with. Has example value.

+ Response 200 (application/json)

    + Body

            {
                "info": {
                    "location_id": 2586,
                    "connected": 1,
                    "children": 2,
                    "last_updated": 1424995575
                },
                "clients": [
                    {
                        "id": "54ec84e261695540ea0000",
                        "online": false,
                        "ip": "",
                        "snr_alert": false,
                        "ap_mac": "xx-A4-3C-02-37-xx",
                        "authenticated": true,
                        "authorized": true,
                        "client_mac": "xx-EE-BD-9B-A3-xx",
                        "created_at": 1424786669,
                        "updated_at": 1424788881,
                        "device_name": "",
                        "name": null,
                        "manufacturer": "HTC Corporation",
                        "snr": 67,
                        "ssid": "AND-PU",
                        "ssids": [
                            "AND-PU"
                        ],
                        "firstseen": 1424786645,
                        "lastseen": 1424788805,
                        "txbytes": 829660,
                        "rxbytes": 923485,
                        "slug": "7gsv8dtigf08dcsy-sbw",
                        "description": "Le Gaff 9",
                        "splash_connected": false,
                        "splash_status": "dnat",
                        "splash_session": "54ec84ad00000001",
                        "splash_username": null,
                        "splash_usernames": null,
                        "splash_in": 0,
                        "splash_out": 0
                    },
                    {
                        "id": "54eef3726169119b4c0400",
                        "online": true,
                        "ip": "192.168.210.45",
                        "snr_alert": true,
                        "ap_mac": "xx-A4-3C-02-37-xx",
                        "authenticated": true,
                        "authorized": true,
                        "client_mac": "xx-72-40-59-D4-xx",
                        "created_at": 1424945984,
                        "updated_at": 1424995575,
                        "device_name": "iPhone",
                        "name": null,
                        "manufacturer": "Apple",
                        "snr": 11,
                        "ssid": "AND-PR",
                        "ssids": [
                            "AND-PR"
                        ],
                        "firstseen": 1424945946,
                        "lastseen": 1424972345,
                        "txbytes": 582678185,
                        "rxbytes": 531322605,
                        "slug": "7gsv8dtiebgf08dcsy-sbw",
                        "description": "Le Gaff 9",
                        "splash_connected": false,
                        "splash_status": null,
                        "splash_session": null,
                        "splash_username": null,
                        "splash_usernames": null,
                        "splash_in": 0,
                        "splash_out": 0
                    }
                ],
                "unique_aps": [
                    {
                        "ap_mac": "xx-A4-3C-02-37-xx",
                        "description": "Le Gaff 9 "
                    }
                ]
            }

# Group Events

Events related resources of the **Events API**. Events run at predefined intervals on your location's boxes.

You can, for example, disable the login screens at lunch or reboot your access point in the evening.

All events run on PolkaSpots boxes (running Stinky Panda). Third party boxes may only receive a selection of events.

##Allowed HTTPs requests:

- `POST` - Creates or updates a resource
- `GET` - Retrieves a resource or list of resources
- `DELETE` - Delete a resource

## Events Collection [/api/v1/locations/{location_id}/events]

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.

### List all Events for a location [GET]

+ Request (application/json)

            { "location_id": "derby-council" }

+ Response 200 (application/json)


    + Body
    
            [
                {
                    "id": 115,
                    "location_id": 870,
                    "event_hour": "09:00",
                    "event_frequency": "Daily",
                    "payload_id": 34,
                    "description": "Reboot my access point ",
                    "unique_id": "6717550402069326522",
                    "slug": null,
                    "command_hash": null,
                    "experimental": false,
                    "premium": false,
                    "active": true,
                    "created_at": "2014-09-17T18:48:23.000+01:00",
                    "updated_at": "2014-09-17T18:48:23.000+01:00"
                }
            ]

## Create an Event [/api/v1/locations/{location_id}/events{?event}]

### Create an Event [POST]

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + event (required, params, `polkaspots.com`) ... parameters required for the creation of the event.

+ Request (application/json)

            {
                "event_hour": "09:00",
                "event_frequency": "Daily",
                "payload_id": 34,
                "description": "Reboot my access point ",
            }

+ Response 200 (application/json)

            {
                "id": 115,
                "location_id": 870,
                "event_hour": "09:00",
                "event_frequency": "Daily",
                "payload_id": 34,
                "description": "Reboot my access point ",
                "unique_id": "6717550402069326522",
                "slug": null,
                "command_hash": null,
                "experimental": false,
                "premium": false,
                "active": true,
                "created_at": "2014-09-17T18:48:23.000+01:00",
                "updated_at": "2014-09-17T18:48:23.000+01:00"
            }

## Delete Event [/api/v1/locations/{location_id}/events/{id}]

### Delete an Event [DELETE]

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, integer, `1`) ... ID of the event you wish to delete.

+ Request (application/json)

        {   
            "location_id": "derby-council",
            "id": 123,
        }

+ Response 204 (application/json)

# Group Firewall

Firewall Rules related resources of the **Firewall Rules API**. Firewalls are a nested in a location. You cannot currently list all your walled gardens without specifying a location id (slug).

Not all the parameters listed in this spec are supported yet.

##Allowed HTTPs requests:

    - `POST` - Creates or updates a resource
    - `PATCH` - Updates a resource
    - `GET` - Retrieves a resource or list of resources
    - `DELETE` - Delete a resource

## Firewall Rules Collection [/api/v1/locations/{location_id}/firewall_rules]

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.

### List all Firewall Rules [GET]

+ Request (application/json)

            { "location_id": "derby-council" }

+ Response 200 (application/json)


    + Body
    
            [
                {
                    "id": 4145,
                    "chain": "FORWARD",
                    "rule_spec": "A",
                    "string_patch": null,
                    "protocol": null,
                    "source_ip": "192.168.4.1/24",
                    "source_port": null,
                    "source_interface": null,
                    "out_interface": null,
                    "dest_ip": "local",
                    "dest_port": null,
                    "target": "DROP",
                    "limit": null,
                    "c_state": null,
                    "log_level": null,
                    "location_id": 870,
                    "position": 1,
                    "created_at": "February 15 2014 19:27:05",
                    "updated_at": "February 15 2014 19:27:05"
                },
                {
                    "id": 4146,
                    "chain": "FORWARD",
                    "rule_spec": "A",
                    "string_patch": null,
                    "protocol": null,
                    "source_ip": "192.168.210.1/24",
                    "source_port": null,
                    "source_interface": null,
                    "out_interface": null,
                    "dest_ip": "local",
                    "dest_port": null,
                    "target": "DROP",
                    "limit": null,
                    "c_state": null,
                    "log_level": null,
                    "location_id": 870,
                    "position": 2,
                    "created_at": "February 15 2014 19:27:05",
                    "updated_at": "February 15 2014 19:27:05"
                },
                {
                    "id": 5848,
                    "chain": "FORWARD",
                    "rule_spec": "I",
                    "string_patch": null,
                    "protocol": null,
                    "source_ip": "192.168.4.1/24",
                    "source_port": null,
                    "source_interface": null,
                    "out_interface": null,
                    "dest_ip": "local",
                    "dest_port": null,
                    "target": "DROP",
                    "limit": null,
                    "c_state": null,
                    "log_level": null,
                    "location_id": 870,
                    "position": 1,
                    "created_at": "September 16 2014 17:53:15",
                    "updated_at": "September 16 2014 17:53:15"
                },
                {
                    "id": 5849,
                    "chain": "FORWARD",
                    "rule_spec": "I",
                    "string_patch": null,
                    "protocol": null,
                    "source_ip": "192.168.210.1/24",
                    "source_port": null,
                    "source_interface": null,
                    "out_interface": null,
                    "dest_ip": "local",
                    "dest_port": null,
                    "target": "DROP",
                    "limit": null,
                    "c_state": null,
                    "log_level": null,
                    "location_id": 870,
                    "position": 2,
                    "created_at": "September 16 2014 17:53:15",
                    "updated_at": "September 16 2014 17:53:15"
                },
                {
                    "id": 5850,
                    "chain": "FORWARD",
                    "rule_spec": "I",
                    "string_patch": null,
                    "protocol": null,
                    "source_ip": "192.168.4.1/24",
                    "source_port": null,
                    "source_interface": null,
                    "out_interface": null,
                    "dest_ip": "local",
                    "dest_port": null,
                    "target": "DROP",
                    "limit": null,
                    "c_state": null,
                    "log_level": null,
                    "location_id": 870,
                    "position": 1,
                    "created_at": "September 16 2014 17:53:49",
                    "updated_at": "September 16 2014 17:53:49"
                },
                {
                    "id": 5851,
                    "chain": "FORWARD",
                    "rule_spec": "I",
                    "string_patch": null,
                    "protocol": null,
                    "source_ip": "192.168.210.1/24",
                    "source_port": null,
                    "source_interface": null,
                    "out_interface": null,
                    "dest_ip": "local",
                    "dest_port": null,
                    "target": "DROP",
                    "limit": null,
                    "c_state": null,
                    "log_level": null,
                    "location_id": 870,
                    "position": 2,
                    "created_at": "September 16 2014 17:53:49",
                    "updated_at": "September 16 2014 17:53:49"
                }
            ]

## Firewall Rule Create [/api/v1/locations/{location_id}/firewall_rules{?firewall_rule}]

### Create a Firewall Rule [POST]

There's two ways to create a firewall rule. You can either post directly with a location id or you update the resource when updating a location. Please see the section within the location's group for more information. 

**CAUSES SYNC**

Please note, creating a new firewall rule will force all your boxes to reload their networks. This *will* log users off.

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + firewall_rule (required, object) ... A list of parameters you want to use to create the firewall rule.

+ Request (application/json)

        { "firewall_rule": 
            {
                "chain": "FORWARD",
                "rule_spec": "I",
                "protocol": null,
                "source_ip": "192.168.1.4/24",
                "source_port": null,
                "source_interface": null,
                "out_interface": null,
                "dest_ip": null,
                "dest_port": null,
                "target": "DROP",
                "limit": null,
                "c_state": null,
                "log_level": null
            }
        }
        

+ Response 200 (application/json)

        {
            "id": 594,
            "chain": "FORWARD",
            "rule_spec": "I",
            "protocol": null,
            "source_ip": "192.168.1.4/24",
            "source_port": null,
            "source_interface": null,
            "out_interface": null,
            "dest_ip": null,
            "dest_port": null,
            "target": "DROP",
            "limit": null,
            "c_state": null,
            "log_level": null,
            "location_id": 2213,
            "position": null,
            "created_at": "2014-09-17T02:10:34.708+01:00",
            "updated_at": "2014-09-17T02:10:34.708+01:00"
        }

## Firewall Rule Update [/api/v1/locations/{location_id}/firewall_rules/{id}?firewall_rule={?params}]

### Update a Firewall Rule [PATCH]

You can also update a firewall rule url by using the location's update method.

**CAUSES SYNC**

Please note, updating a firewall rule will force all your boxes to reload their networks. This *will* log users off.

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, integer, `1`) ... ID of the walled garden you wish to update.
    + params (required, string, `params hash`) ... A list of parameters you wish to update.

+ Request (application/json)

        { "firewall_rule": 
            {
                "id": "594",
                "chain": "FORWARD",
                "rule_spec": "I",
                "protocol": null,
                "source_ip": "192.168.0.4/24",
                "source_port": null,
                "source_interface": null,
                "out_interface": null,
                "dest_ip": null,
                "dest_port": null,
                "target": "DROP",
                "limit": null,
                "c_state": null,
                "log_level": null
            }
        }

+ Response 200 (application/json)

        {
            "id": 594,
            "chain": "FORWARD",
            "rule_spec": "I",
            "protocol": null,
            "source_ip": "192.168.0.4/24",
            "source_port": null,
            "source_interface": null,
            "out_interface": null,
            "dest_ip": null,
            "dest_port": null,
            "target": "DROP",
            "limit": null,
            "c_state": null,
            "log_level": null,
            "location_id": 2213,
            "position": null,
            "created_at": "2014-09-17T02:10:34.708+01:00",
            "updated_at": "2014-09-17T02:10:34.708+01:00"
        }

## Firewall Rule Delete [/api/v1/locations/{location_id}/firewall_rules/{id}]

### Delete a Walled Garden [DELETE]

**CAUSES SYNC**

Please note, creating a new walled garden will force all your boxes to reload their group network. This *will* log users off.

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, integer, `1`) ... ID of the firewall rule you wish to update.

+ Request (application/json)

        {   
            "location_id": "derby-council",
            "id": 123,
        }

+ Response 204 (application/json)

# Group Invites

Invites related resources of the **Invites API**

This facilitates the addition and removal of admin users. Admin users are able to alter location settings, view reports etc.

## Invites Collection [/api/v1/invites]

You can retrieve a list of all your invites, including the state of the invitation.

When you invite a new user to CT, they will receive an email confirmation and are required to create a new account. Invitations will expire in three days for security reasons.

After they have accepted the invitation, they will be automatically added to locations you invited them to.

You may invite users to all your locations or a single location.

### List all invites [GET]

+ Request (application/json)

    + Header

            Accept: application/json

+ Response 200 (application/json)

    + Body
          
            [
                {
                    "parent_id": null,
                    "email": "bob@marley.com",
                    "created_at": 1425215591,
                    "expires": 1425474791,
                    "state": "pending",
                    "location_ids": [
                        "46",
                        "53",
                        "119",
                        "1778",
                        "1806",
                        "1813",
                        "1816"
                    ],
                    "name": "Bob Marley",
                    "id": "54f310674c697a9f2e010000"
                }
            ]

## Viewing Invites [/api/v1/invites/{id}]

You can view a full invitation include the location details using the following end-point. 

### View an invite [GET]

+ Parameters

    + id (required, string, `123`) ... ID of the invite you want to view. Has example value.

+ Response 200 (application/json)

    + Body
    
            {
                "invite": {
                    "email": "bob@marley.com",
                    "name": "Bob Marley",
                    "state": "pending",
                    "timestamp": 1425215591,
                    "expires": 1425474791
                },
                "locations": [
                    {
                        "location_name": "Long Buckby Railway Station (LBK)",
                        "slug": "long-buckby-railway-station-lbk"
                    },
                    {
                        "location_name": "The Jerusalem Tavern",
                        "slug": "the-jerusalem-tavern-109d6397-24e9-493e-9645-36d24def92db"
                    },
                    {
                        "location_name": "Simon",
                        "slug": "simon-53dbb7bd-eac7-4860-8dfb-9490d4433ecc"
                    },
                    {
                        "location_name": "Stuff got real",
                        "slug": "stuff-got-real-four-1c94fe7e-6823-46c4-8425-160c63c00aea"
                    }
                ]
            }


## Managing Invites [/api/v1/invites/{email,location_ids}]

### Create an invitation [POST]

This is how you invite a user to administer a location or locations. If you do not pass any location_ids, we will assume you want to invite them to all your locations. 

The location id is the numeric id of the location you want to invite them to. Please use the Location API to obtain these.

You must wrap the request in the invite object.

Please also note that invitations are not available on all plans. Unaccepted invites are deleted automatically after three days and must be resent.

+ Parameters

    + email (required, string, `bob@marley.com`) ... Email of the person you want to invite..
    + location_ids (optional, string, `1,2,3`) ... The numeric ids of the locations you want to invite the user to manage.

+ Request (application/json)

        "invite":
            
            {
                email: 'email-of-person@gmail.com',
                location_ids: '1,2,3,4'
            }    
    
+ Response 200 (application/json)

    + Body

            {
                "parent_id": null,
                "email": "bob@marley.com",
                "created_at": 1425215591,
                "expires": 1425474791,
                "state": "pending",
                "location_ids": [
                    "46",
                    "53",
                    "119",
                    "1778",
                    "1806",
                    "1813",
                    "1816"
                ],
                "name": "Bob Marley",
                "id": "54f310674c697a9f2e010000"
            }

### Revoke an invitation [DELETE]

+ Request (application/json)

        "invite":

            {
                email: 'email-of-person@gmail.com',
                location_ids: '1,2,3,4'
            }    

+ Response 200 (application/json)

    + Body

            {
                "parent_id": null,
                "email": "bob@marley.com",
                "created_at": 1425215591,
                "expires": 1425474791,
                "state": "pending",
                "location_ids": [
                    "46",
                    "53",
                    "119",
                    "1778",
                    "1806",
                    "1813",
                    "1816"
                ],
                "name": "Bob Marley",
                "id": "54f310674c697a9f2e010000"
            }


# Group Invoices

The main device invoices API which displays your service invoices.

Using this API, you can request copies of your invoices to be sent to your billing contacts. Handy.

##Allowed HTTPs requests:

- `GET` - Retrieves a resource or list of resources
- `POST` - Emails one or more invoices to your billing contacts.

## Invoices Collection [/api/v1/invoices]

### List Invoices [GET]

+ Response 200 (application/json)

    + Body

## Display an invoice [/api/v1/invoices/{id}]

### Display Invoices [GET]

+ Parameters

    + id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... ID of the invoice you want to retreive.

+ Response 200 (application/json)

    + Body

## Email your invoices [/api/v1/invoices/email?{ids}]

You can ask CT to send an invoice or invoices to your billing contacts. Billing contacts are part of the users API, see below for more information.

### Emails Invoices [POST]

+ Parameters

    + ids (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Comma separated list of emails to send via email.

+ Response 200 (application/json)

    + Body

# Group Locations

Locations related resources of the **Locations API**

Please see the location object for a list of parameters you can update. Some are obviously read only.

## Locations Collection [/api/v1/locations]

### List all Locations [GET]

+ Request (application/json)

    + Header

            Accept: application/json

+ Response 200 (application/json)

        [{
            "id": 1687,
            "location_name": "Cafe International",
            "slug": "cafe-international-f84e1979-52e4-49ff-8d6e-ed808578b36a",
            "created_at": "May 6 2014 11:47:08",
            "network_name": "PolkaSpots",
            "location_address": "12 High Lane",
            "street": "12 High Lane",
            "phone1": "02071831471",
            "location_website": null,
            "location_type": null,
            "nas_count": 1,
            "archived": false,
            "development_mode": "Production",
            "daily_limit": true
        },
        {
            "id": 870,
            "location_name": "Derby - City Council",
            "slug": "derby-city-council",
            "created_at": "August 19 2013 11:50:04",
            "network_name": "Meraki",
            "location_address": "Corporation Street Derby ",
            "street": "",
            "phone1": "01332293111",
            "location_website": "www.surfthecity.co.uk",
            "location_type": "186",
            "nas_count": 5,
            "archived": false,
            "development_mode": "Production",
            "daily_limit": true
        }]

## Locations Search [/api/v1/locations?q={search}]

### Search for locations [GET]

+ Parameters

    + q (required, string, `Some Search Text`) ... What are you looking for?

+ Request (application/json)

    + Headers

            Accept: application/json

    + Body

            { "q": "derby" }

+ Response 200 (application/json)

        [{
            "id": 870,
            "location_name": "Derby - City Council",
            "slug": "derby-city-council",
            "created_at": "August 19 2013 11:50:04",
            "network_name": "Meraki",
            "location_address": "Corporation Street Derby ",
            "street": "",
            "phone1": "01332293111",
            "location_website": "www.surfthecity.co.uk",
            "location_type": "186",
            "nas_count": 5,
            "archived": false,
            "development_mode": "Production",
            "daily_limit": true
        }]

## Locations Short List [/api/v1/locations?short=yep{?q}]

Returns a mini-list of your locations. Is good for search, cloning the logins, stuff where you don't need much info.

### A consolidated list of locations [GET]

+ Parameters

    + q (optional, string, `Some Search Text`) ... What are you looking for?

+ Request (application/json)

    + Headers
    
            Accept: application/json

    + Body

            { "short": "yep" }

+ Response 200 (application/json)

    + Body
    
            [
                {
                    "id": 2614,
                    "location_name": "Ski Center",
                    "slug": "ski-center-8b71-407b-aeb0-fe875bbd3763",
                    "network_name": "PolkaSpots",
                    "location_address": null,
                    "street": null,
                    "phone1": null,
                    "location_website": null,
                    "location_type": null,
                    "archived": false,
                    "development_mode": "Production",
                    "daily_limit": true,
                    "created_at": 1425115597,
                    "updated_at": 1425115597,
                    "user_id": 3363,
                    "lat": 52.0406,
                    "lng": -0.759417,
                    "summary": {
                        "boxes_alerting": false,
                        "boxes_count": 0,
                        "total_sessions": "0",
                        "total_downloads": 0,
                        "connected_clients": 0,
                        "plan": "Little Tony"
                    }
                },
                {
                    "id": 2613,
                    "location_name": "Long Heights",
                    "slug": "long-heights-4b15f473-e99f-4c18-9639-6106e4b3fd2b",
                    "network_name": "PolkaSpots",
                    "location_address": null,
                    "street": null,
                    "phone1": null,
                    "location_website": null,
                    "location_type": null,
                    "archived": false,
                    "development_mode": "Production",
                    "daily_limit": true,
                    "created_at": 1425049469,
                    "updated_at": 1425049809,
                    "user_id": 3362,
                    "lat": 51.7242,
                    "lng": -3.36022,
                    "summary": {
                        "boxes_alerting": false,
                        "boxes_count": 0,
                        "total_sessions": "0",
                        "total_downloads": 0,
                        "connected_clients": 0,
                        "plan": "Little Tony"
                    }
                }
            ]
            
            
## Create a location [/api/v1/locations{?location}]

Default required params include:

- location_name
- address
- town
- postcode

You may send an array of mac addresses to create boxes associated with the location. This must follow the following convention:

    { "boxes": { "ap_mac": ["00:22:22:11:22:33", "66:22:11:22:33:44"] }

You can also send a facebook_id with your request. Doing so will cause CT to totally ignore the data you've sent. Instead, Cucumber Tony will contact Facebook and grab the information from them instead.

    { "location": { "facebook_id": "valid-fb-id" } }
    
### Create a Location [POST]

+ Parameters

    + location (required, JSON object, `location_name: derby-city-council`) ... JSON object of all the parameters you wish to create your location with.

+ Request (application/json)

        "location":
            {
                "location_name": "Derby Council",
                "address": "1 Really Long Road",
                "town": "A far away land",
                "postcode": "EC1M",
                "phone1": '01604 134 1679',
                "facebook_id": "187263871623"
            },
        "boxes":
        
            { "ap_mac": ["AA:BB:CC:DD:EE:FF:11"] }

+ Response 200 (application/json)

        {
            "id": 1768,
            "slug": "derby-ff3b5382-baa5-4ecd-945a-526427e057a1",
            "created_at": "September24201419: 07: 09",
            "attr_generated": false,
            "location_address": "62 Britton Street",
            "location_name": "PolkaSpots"
        }

## Location [/location/{id}]

A single Location object with all its details. Includes information relating to the account owner and their plan for good measure.

+ Parameters

    + id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.

### Retrieve a Location [GET]

+ Response 200 (application/json)

    + Header

            Accept: application/json

    + Body

            {
                "id": 2586,
                "discovering": false,
                "location_name": "Le Gaff",
                "unique_id": "xxxx",
                "slug": "le-gaff",
                "created_at": 1424212121,
                "updated_at": 1424942703,
                "location_address": "Dans Le Rue",
                "street": null,
                "postcode": "EC1M 5UY",
                "town": "London",
                "country": "United Kingdom",
                "website": null,
                "email_owner": null,
                "phone1": null,
                "location_website": null,
                "created_by": null,
                "location_notes": null,
                "networktype_id": 2,
                "api_token": "xxx-c4bb-4375-8acb-329569d85b86",
                "state": "active",
                "archived": false,
                "latitude": 25.5253,
                "longitude": -33.5597,
                "development_mode": "Production",
                "wisp_id": 6,
                "tagged_logins": false,
                "flume_enabled": false,
                "meraki_validator": null,
                "attr_generated": true,
                "total_sessions": "171",
                "plan_name": "Uncle Tony",
                "address_string": "Dans Le Rue",
                "full_address": "Dans Le Rue",
                "setup_fin": true,
                "logins_fin": false,
                "access_fin": false,
                "networks_fin": false,
                "has_nas": true,
                "user_id": 1,
                "primary_user": {
                    "role": "Customer",
                    "plan": {
                        "plan_name": "Uncle Tony",
                        "plan_description": "For hotels, offices and small franchises",
                        "location_count": 30,
                        "hotspot_count": 30,
                        "voucher_count": 5000,
                        "email_support": true,
                        "phone_support": false,
                        "billing_period": "monthly",
                        "daily_sessions": 1000,
                        "shop_allowed": false,
                        "enterprise_plan": false,
                        "max_location_users": 5,
                        "plan_price": "36.0",
                        "max_networks": 2,
                        "id": null
                    },
                    "user": {
                        "username": "Big Chief",
                        "email": "Bob@ps.com",
                        "slug": "bob-marley",
                        "id": 1,
                        "unique_id": "520552203",
                        "account_id": "A3F71F6"
                    }
                },
                "can_delete": false,
                "clone_processing": false,
                "beta_mode": false
            }
            
### Update a Location [PATCH]

Update your location settings and information.

+ Response 200 (application/json)

    + Header

            Accept: application/json

    + Body

            {
                "id": 2586,
                "discovering": false,
                "location_name": "Le Gaff",
                "unique_id": "xxxx",
                "slug": "le-gaff",
                "created_at": 1424212121,
                "updated_at": 1424942703,
                "location_address": "Dans Le Rue",
                "street": null,
                "postcode": "EC1M 5UY",
                "town": "London",
                "country": "United Kingdom",
                "website": null,
                "email_owner": null,
                "phone1": null,
                "location_website": null,
                "created_by": null,
                "location_notes": null,
                "networktype_id": 2,
                "api_token": "xxx-c4bb-4375-8acb-329569d85b86",
                "state": "active",
                "archived": false,
                "latitude": 25.5253,
                "longitude": -33.5597,
                "development_mode": "Production",
                "wisp_id": 6,
                "tagged_logins": false,
                "flume_enabled": false,
                "meraki_validator": null,
                "attr_generated": true,
                "total_sessions": "171",
                "plan_name": "Uncle Tony",
                "address_string": "Dans Le Rue",
                "full_address": "Dans Le Rue",
                "setup_fin": true,
                "logins_fin": false,
                "access_fin": false,
                "networks_fin": false,
                "has_nas": true,
            }

### Remove a Location [DELETE]

You can remove a location as long as it doesn't have any session information associated with it. This is important in order to be compliant with the law if you're offering public access.

+ Parameters

    + id (required, string, `le-gaff`) ... Slug / ID of the location you want to delete.

+ Request (application/json)

        {   "id": 'le-gaff-123'  }

+ Response 204 (application/json)

## Location Statistics [/location/{id}/stats]

A single Location's statistical objects

+ Parameters

    + id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.

### Retrieve a Location's Statistics [GET]

+ Response 200 (application/json)

    + Header

            Accept: application/json

    + Body

            {
                "slug": "derby-city-council",
                "lat": null,
                "lon": null,
                "sessions": 0,
                "uniques": 0,
                "minutes_online": 0,
                "downloads": 0,
                "busiest_hr": null,
                "busiest_day": null,
                "total_sales": 0,
                "qnty_sales": 0,
                "range": "07/28/2014 - 09/08/2014",
                "chart_series": {
                    "Sessions": "[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]",
                    "Unique users": "[0,16,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]"
                },
                "audience": [],
                "loyalty": {
                    "new": 0,
                    "returning": null
                },
                "geojson": [
                    {
                        "lat": null,
                        "lon": null,
                        "title": "Derby City Council 6",
                        "slug": "xxx",
                        "colour": "#DE2AE5",
                        "network": "meraki",
                        "description": "Derby City Council 6",
                        "mac": "00-18-0A-XX-XX-XX",
                        "sessions": null,
                        "heartbeat": null
                    },
                    {
                        "lat": "28.15303332447874",
                        "lon": "-60.83188607793834",
                        "title": "Derby City Council",
                        "slug": "xxx",
                        "colour": "#DE2AE5",
                        "network": "meraki",
                        "description": "Derby City Council",
                        "mac": "00-18-0A-XX-XX-XX",
                        "sessions": null,
                        "heartbeat": null
                    },
                    {
                        "lat": "-24.1850770453765",
                        "lon": "-162.5053433148802",
                        "title": "Derby City Council",
                        "slug": "xxx",
                        "colour": "#DE2AE5",
                        "network": "meraki",
                        "description": "Derby City Council",
                        "mac": "00-18-0A-XX-XX-XX",
                        "sessions": null,
                        "heartbeat": null
                    },
                    {
                        "lat": "-39.74956573964626",
                        "lon": "176.4442398543561",
                        "title": "Derby Council 2",
                        "slug": "xxx",
                        "colour": "#DE2AE5",
                        "network": "meraki",
                        "description": "Derby Council 2",
                        "mac": "00-18-0A-XX-XX-XX",
                        "sessions": null,
                        "heartbeat": null
                    },
                    {
                        "lat": null,
                        "lon": null,
                        "title": "Derby - City Council 6",
                        "slug": "xxx",
                        "colour": "#DE2AE5",
                        "network": "meraki",
                        "description": "Derby - City Council 6",
                        "mac": "00-18-0A-XX-XX-XX",
                        "sessions": null,
                        "heartbeat": null
                    }
                ],
                "top_boxes": []
            }
                
## Get Location Users [/location/{id}/users]

Get a list of all the users who have access to your location. The output will include four keys - **owner, admins, invites**

- The owners object contains details of the primary user's plan.
- The admin users object contains all users will admin rights to the location.
- The invites object represents and invitations which have been sent recently.

If you want to add users to a location or locations, please use the Invites API.

+ Parameters
    + id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.

### Get a list of location users [GET]

+ Request (application/json)

    + Headers
    
            Accept: application/json

    + Body
    
            { "id": "derby-city-council" }

+ Response 200 (application/json)

    + Header

            Accept: application/json

    + Body

            {
                "location_name": "Derby City Centre",
                "unique_id": "432692681892998301233",
                "slug": "derby-city-council",
                "admin_users": {
                    "admins": [
                        {
                            "email": "bob@derby.gov.uk",
                            "username": "Bob Marley",
                            "unique_id": "29789523",
                            "slug": "bob-marley"
                        },
                        {
                            "email": "support@polkaspots.com",
                            "username": "Steve Jobs",
                            "unique_id": "82052203",
                            "slug": "steve-jobs"
                        }
                    ],
                    "owner": {
                        "username": "Barry White",
                        "slug": "barry-white",
                        "unique_id": "206923464",
                        "email": "barry@derby.gov.uk",
                        "plan_name": "Enterprise",
                        "max_location_users": 10
                    },
                    "invites": [
                        {
                            "token": "e7adddb4e68a6f250a57b3f7b1dd31e3",
                            "email": "user@polkaspots.com",
                            "created_at": "1410737982"
                        },
                        {
                            "token": "e924c0ae9ea4a462a55dbd7be6d0ee23",
                            "email": "user2@polkaspots.com",
                            "created_at": "1410737979"
                        },
                        {
                            "token": "a863527a40c694173d59ef5c5201d307",
                            "email": "user3@polkaspots.com",
                            "created_at": "1410737976"
                        }
                    ]
                }
            }

## Clone a specific location [/location/{id}/duplicate{?location_name,address,users}]

Create a carbon copy of a location.

This job is processed in the background and you can't copy a location while there's already a clone in process. To check for the clone status, use the show action and attribute **clone_processing**. This will be true if there's a job underway.

+ Parameters

    + id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + location_name (required, string, `My New Site`) ... The name of the new location.
    + address (required, string, `12 High Road, Derby D11`) ... The address of the new location, also required.
    + users (not-required, string, `true`) ... You can also copy existing admin users to the new location by setting this flag.

### Duplicate a location [POST]

+ Request (application/json)

    + Headers
    
            Accept: application/json

    + Body
    
            {
                "id": "derby-council",
                "location_name": "My New Site",
                "address": "12 High Road, Derby D1",
                "users": 'any-value'
            }

+ Response 200 (application/json)

    + Body

            { "message": "Your location has been queued for duplication. This may take a few minutes." } 

## Transfer a location [/location/{id}/transfer{?account_id}]

Copy the location to another user. If you transfer a location to a user with insufficient quota, the transfer will fail with a 422 error. Equally, a location can only be transferred if it's state is active.

It's really important to note that transferring a location will remove all location users. The new owner will need to re-invite all the users they require to administer the location.

+ Parameters

    + id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + account_id (required, string, `A33333`) ... Account ID of the person to transfer the location to. Always starts with A.

### Transfer a location [POST]

+ Request (application/json)

    + Headers
    
            Accept: application/json

    + Body
    
            {
                "id": "derby-council",
                "account_id": "A111111"
            }

+ Response 200 (application/json)

    + Body

            { "message": "Your location is being transferred." } 

## Archive a specific location [/location/{id}/archive]

If you don't want to delete a location permanently, you can choose to archive it instead. Archived locations don't count towards your quota and you cannot use an archived location for public access.

+ Parameters

    + id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.

### Archive a location [POST]

+ Request (application/json)

    + Headers
    
            Accept: application/json

    + Body
    
            { "id": "derby-council", }

+ Response 200 (application/json)

    + Body

            { "message": "Your location has been archived" } 

## Restore / Unarchive a specific location [/location/{id}/unarchive]

Restore an archived location to it's former glory.

+ Parameters

    + id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.

### Archive a location [POST]

+ Request (application/json)

    + Headers
    
            Accept: application/json

    + Body
          
            { "id": "derby-council" }

+ Response 200 (application/json)

    + Body

            { "message": "Your location has been unarchived" } 

## Update a Location's firewall rules [/api/v1/location/{id}{?location,firewall_rules_attributes,params}]

You can either create firewall rules directly with the Firewall Rules API or you may update, create and delete when updating a location.

You must wrap the firewall_rules_attributes params in the location params. 

To delete a rule, simply set the _destroy field to 1.

By sending the ID of the firewall rule, we will assume you're going to update the values.

**NOTES**

Whilst it's ok to send the whole location object back when updating the firewall rules, your response times will be faster if you reduce the size of the request (see request below for an example). We'd recommend sending only the required location params back, id, slug and any others you may want to update.

+ Parameters

    + id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + location (required, object ) ... An object which contains the firewall rule attributes
    + firewall_rules_attributes (required, object ) ... An object of firewall rule attributes

### Update your firewall rules [PATCH]

+ Request (application/json)

    + Headers
    
            Accept: application/json

    + Body
    
            {"location":
                {
                    "slug": "derby-city-council",
                    "id": 870,
                    "block_access_to_local": true,
                    "firewall_rules_attributes": [
                        {
                            "id": 5850,
                            "chain": "FORWARD",
                            "rule_spec": "I",
                            "string_patch": null,
                            "protocol": null,
                            "source_ip": "192.168.4.124",
                            "source_port": 12,
                            "source_interface": null,
                            "out_interface": null,
                            "dest_ip": "local",
                            "dest_port": 34,
                            "target": "ACCEPT",
                            "limit": null,
                            "c_state": null,
                            "log_level": null,
                            "location_id": 870,
                            "position": 1
                        },
                        {
                            "id": 5851,
                            "chain": "FORWARD",
                            "rule_spec": "I",
                            "string_patch": null,
                            "protocol": null,
                            "source_ip": "192.168.210.124",
                            "source_port": null,
                            "source_interface": null,
                            "out_interface": null,
                            "dest_ip": "local",
                            "dest_port": null,
                            "target": "ACCEPT",
                            "limit": null,
                            "c_state": null,
                            "log_level": null,
                            "location_id": 870,
                            "position": 2
                        },
                        {
                            "id": 5852,
                            "chain": "FORWARD",
                            "rule_spec": "A",
                            "string_patch": null,
                            "protocol": null,
                            "source_ip": "192.168.4.124",
                            "source_port": 1212,
                            "source_interface": null,
                            "out_interface": null,
                            "dest_ip": "local",
                            "dest_port": 1212,
                            "target": "ACCEPT",
                            "limit": null,
                            "c_state": null,
                            "log_level": null,
                            "location_id": 870,
                            "position": null,
                            "_destroy": "1"
                        }
                    ]
                }
            }

+ Response 200 (application/json)

    + Body

            { "message": "You have updated Derby Council" } 

# Group Jobs

Jobs, or events as they should really be named, are things that happen to your boxes. Jobs include device heartbeats, payload commands and more. 

They are a nested resource in the Boxes API.

##Allowed HTTPs requests:

- `GET` - Retrieves a resource or list of resources

## Jobs Collection [/api/v1/boxes/{box_id}/jobs]

You can filter the log_level betweeen 1 and 3.

### List Box jobs [GET]

+ Parameters

    + box_id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the Box to perform action with. Has example value.

+ Response 200 (application/json)

    + Body
    
            [{
                "resource": "nas",
                "log_level": 1,
                "private": null,
                "event_id": "a563101c78f51a1c308b1bb3b0d1d9f3",
                "user_id": null,
                "data": {
                    "timestamp": 1412212262,
                    "resource_id": "JCyK7Zwh0ON_ZOWso8Mhuw",
                    "message": "device heartbeat",
                    "mac": null,
                    "type": "state_event",
                    "nas": {
                        "state": null
                    }
                }
            },
            {
                "resource": "nas",
                "log_level": 3,
                "private": null,
                "event_id": "fbaafd9701de91b50d40fd60ca184a1f",
                "user_id": null,
                "data": {
                    "timestamp": 1412212261,
                    "resource_id": "JCyK7Zwh0ON_ZOWso8Mhuw",
                    "message": "Box with mac DC-9F-DB-3D-AC-49 went queued",
                    "mac": "DC-9F-DB-3D-AC-49",
                    "type": "state_event",
                    "nas": {
                        "state": "queued"
                    }
                }
            },
            {
                "resource": "nas",
                "log_level": 3,
                "private": null,
                "event_id": "1bf3e698075d27366eb6476de15dced3",
                "user_id": null,
                "data": {
                    "timestamp": 1412212261,
                    "resource_id": "JCyK7Zwh0ON_ZOWso8Mhuw",
                    "message": "Box with mac DC-9F-DB-3D-AC-49 went queued",
                    "mac": "DC-9F-DB-3D-AC-49",
                    "type": "state_event",
                    "nas": {
                        "state": "queued"
                    }
                }
            }]
        
# Group Metrics

Get aggregated and serial reporting data about your networks and usage.

This only available to enterprise users or those using the sense service.

A stay is a representation of a completed visit for a specific box & client. Stays are used to determine dwell times.

A stay has a start time and an end time and they are grouped by:

- Client MAC
- Box MAC
- Date

A stay is considered complete when the device has not been seen for more than 30 minutes.

For example, a device is first seen at 10am. The device is seen every minute until 11am. After which they device leaves the access point. Cucumber Tony will automatically mark this as a completed stay. This may not be completed immediately.

Should they come back after 30 minutes have passed, we will start a new stay for them.

If the device is seen only once, we consider the device to have passed through - this does not affect your dwell times.

Stays currently consider both associated and unassociated clients.

You may pass in various parameters to filter the results in different ways. See below.

The only end-point required is /api/v1/metrics - this provides all the required currently available public data. Filters are passed in as search params.

You can pass in your location_ids & ap_macs to filter for each action.

##Allowed HTTPs requests:

- `GET` - Retrieves a resource or list of resources

## Overview of Stays [/api/v1/metrics/{?location_ids,ap_macs,start,end}]

Summary stats of your network dwell times and stays including the counts, averages, max and min. values. You can filter using your location_ids or ap_macs as arrays.

+ Parameters

    + location_ids (optional, integer, `1,2,3`) ... Comma separated list of location IDs to filter the results.
    + ap_macs (optional, string, `11:22:11:22:22:11`) ... Comma separated list of mac addresses to filter the results.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 100 days ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to now.
    
### Summary stats for dwells, stays and sessions [GET]

+ Response 200 (application/json)

    + Body

            {
                "dwells": {
                    "dwells": {
                        "count": 4308144,
                        "min": 8979,
                        "max": 89987,
                        "avg": 677.060867974701,
                        "sum": 2916875716
                    },
                    "stays": {
                        "count": 2269436,
                        "min": 1,
                        "max": 326,
                        "avg": 2.066425314483422,
                        "sum": 4689620
                    },
                    "sessions": {
                        "count": 5874380,
                        "min": 1,
                        "max": 5077,
                        "avg": 9.827615169600877,
                        "sum": 57731146
                    }
                }
            }            

## Aggregated sessions, dwells and stays [/api/v1/metrics/{?aggs,location_ids,start,end,key,ap_macs}]

Aggregated summary data grouped by location_id. This provides a summary of dwell times for each invidivual location. Please use the locations api to determine full location information from the id. It is required you pass the search parameter "aggs" to use this end point. The key is equal to your location id

+ Parameters

    + aggs (required, boolean, `true`) ... Required to provide aggregated results.
    + key (optional, boolean, `location_id`) ... Required to provide aggregated results by location_id.
    + location_ids (optional, integer, `1,2,3`) ... Comma separated list of location IDs to filter the results.
    + ap_macs (optional, string, `11:22:11:22:22:11`) ... Comma separated list of mac addresses to filter the results.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 100 days ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to now.
    
### Aggregated data grouped by location_id [GET]

+ Response 200 (application/json)

    + Body

            {
                "aggs": {
                    "count": 3,
                    "locations": [
                        {
                            "key": "32",
                            "dwells": {
                                "count": 3,
                                "min": 1000,
                                "max": 1000,
                                "avg": 1000,
                                "sum": 3000
                            },
                            "sessions": {
                                "count": 3,
                                "min": 1,
                                "max": 1,
                                "avg": 1,
                                "sum": 3
                            },
                            "stays": {
                                "count": 3,
                                "min": 12,
                                "max": 12,
                                "avg": 12,
                                "sum": 36
                            }
                        }
                    ]
                }
            }            
            
## Aggregated by ap_mac [/api/v1/metrics/{?aggs,location_ids,ap_macs,start,end,key}]

Aggregated summary data grouped by ap_mac. This provides a summary of dwell times for each invidivual access point. 

Pass key=ap_mac with the search params to group by ap_mac.

+ Parameters

    + aggs (required, boolean, `true`) ... Required to provide aggregated results.
    + key (required, string, `ap_mac`) ... Required to provide aggregated results by mac address of access point.
    + location_ids (optional, integer, `1,2,3`) ... Comma separated list of location IDs to filter the results.
    + ap_macs (optional, string, `11:22:11:22:22:11`) ... Comma separated list of mac addresses to filter the results.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 100 days ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to now.
    
### Aggregated data grouped by ap_mac [GET]

+ Response 200 (application/json)

## Aggregated by manufacturer [/api/v1/metrics/{?aggs,location_ids,ap_macs,start,end,key}]

Aggregated summary data grouped by manufacturer. Pass key=man with query to activate.

+ Parameters

    + aggs (required, boolean, `true`) ... Required to provide aggregated results.
    + key (required, string, `man`) ... Required to provide aggregated results by manufacturer.
    + location_ids (optional, integer, `1,2,3`) ... Comma separated list of location IDs to filter the results.
    + ap_macs (optional, string, `11:22:11:22:22:11`) ... Comma separated list of mac addresses to filter the results.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 100 days ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to now.
    
### Aggregated data grouped by manufacturer [GET]

+ Response 200 (application/json)

    + Body

            {
                "aggs": {
                    "count": 3,
                    "locations": [
                        {
                            "key": "apple",
                            "dwells": {
                                "count": 3,
                                "min": 1000.0,
                                "max": 1000.0,
                                "avg": 1000.0,
                                "sum": 3000.0
                            },
                            "sessions": {
                                "count": 3,
                                "min": 1.0,
                                "max": 1.0,
                                "avg": 1.0,
                                "sum": 3.0
                            },
                            "stays": {
                                "count": 3,
                                "min": 12.0,
                                "max": 12.0,
                                "avg": 12.0,
                                "sum": 36.0
                            }
                        }
                    ]
                }
            }            

## Aggregated by time [/api/v1/metrics/{?aggs,location_ids,ap_macs,start,end,key}]

Aggregated summary data grouped by time. You can pass in key=hour or key=day to group accordingly.

The key will be the day number or hour.

+ Parameters

    + aggs (required, boolean, `true`) ... Required to provide aggregated results.
    + key (required, string, `day`) ... Required to provide aggregated results by day or hour.
    + location_ids (optional, integer, `1,2,3`) ... Comma separated list of location IDs to filter the results.
    + ap_macs (optional, string, `11:22:11:22:22:11`) ... Comma separated list of mac addresses to filter the results.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 100 days ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to now.
    
### Aggregated data grouped by time [GET]

+ Response 200 (application/json)

    + Body
            
            {
                "aggs": {
                    "count": 3,
                    "locations": [
                        {
                            "key": 3,
                            "dwells": {
                                "count": 2,
                                "min": 1000.0,
                                "max": 1000.0,
                                "avg": 1000.0,
                                "sum": 2000.0
                            },
                            "sessions": {
                                "count": 2,
                                "min": 1.0,
                                "max": 1.0,
                                "avg": 1.0,
                                "sum": 2.0
                            },
                            "stays": {
                                "count": 2,
                                "min": 12.0,
                                "max": 12.0,
                                "avg": 12.0,
                                "sum": 24.0
                            }
                        },
                        {
                            "key": 4,
                            "dwells": {
                                "count": 1,
                                "min": 1000.0,
                                "max": 1000.0,
                                "avg": 1000.0,
                                "sum": 1000.0
                            },
                            "sessions": {
                                "count": 1,
                                "min": 1.0,
                                "max": 1.0,
                                "avg": 1.0,
                                "sum": 1.0
                            },
                            "stays": {
                                "count": 1,
                                "min": 12.0,
                                "max": 12.0,
                                "avg": 12.0,
                                "sum": 12.0
                            }
                        }
                    ]
                }

## Histogram of sessions, dwells and stays grouped by day or hour [/api/v1/metrics/{?timeline,location_ids,ap_macs,start,end}]

This provides a timeline of sessions for your locations or aps. Pass timeline = true with params. The key is linux / epoch time.

+ Parameters

    + timeline (required, boolean, `true`) ... Required to provide aggregated results.
    + location_ids (optional, integer, `1,2,3`) ... Comma separated list of location IDs to filter the results.
    + ap_macs (optional, string, `11:22:11:22:22:11`) ... Comma separated list of mac addresses to filter the results.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 100 days ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to now.
    
### Timeline data grouped by date [GET]

+ Response 200 (application/json)

    + Body
    
            {
                "timeline": {
                    "count": 3,
                    "timeline": [
                        {
                            "key": 1417046400000,
                            "avg": 1,
                            "total": 119298
                        },
                        {
                            "key": 1417219200000,
                            "avg": 1,
                            "total": 131233
                        },
                        {
                            "key": 1418601600000,
                            "avg": 1,
                            "total": 112311
                        }
                    ]
                }
            }    


# Group Networks

Networks represent SSIDs. You can add up to 16 networks per location however, we rarely recommend doing so. The more networks you add, the lower the performance.

Ideally, you would add no more than 4 per box (depending on the model). 

Why do we allow 16 then? If you combine networks with the all-powerful zones, you can affectively create 16 individual zones per location, each with a different SSID. 

The idea is that you can offer different networks in different parts of your building.

If you are home user, you might never need 16 SSIDs but you may want a separate one for you kids. Alternatively, if you are a hotel, you could offer a network with captive portal only in certain areas of the hotel.

**Network Sync**

After you create, update or destroy a network, we will try and sync your boxes. You have an opportunity after creation to delete / cancel the job and reschedule it later. For more information, please consult the update section.

## Networks Collection [/api/v1/locations/{location_id}/networks]

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.

### List all Networks [GET]

+ Request (application/json)

    + Headers
    
            Accept: application/json

    + Body
    
            [
                {
                    "id": "54ee7b1472616970353c2600",
                    "network_name": "public",
                    "description": "Primary network",
                    "active": true,
                    "network_radio_mode": null,
                    "interface_ipaddr": "192.168.4.1",
                    "interface_netmask": "24",
                    "dhcp_start": 100,
                    "dhcp_end": 250,
                    "dhcp_lease": "12h",
                    "dhcp_limit": 100,
                    "captive_portal_url": "http://polkaspots.my-wifi.co/",
                    "captive_portal_port": 3990,
                    "captive_portal_uamsecret": "xxx",
                    "captive_portal_allowed_hosts": "8.8.8.8,208.67.222.222,208.67.220.220",
                    "captive_portal_allowed_macs": "",
                    "captive_portal_walledgardens": null,
                    "content_filter": "Security",
                    "radius_host_1": "cluster-1.polkaspots.co",
                    "radius_host_2": "cluster-2.polkaspots.co",
                    "radius_secret_1": null,
                    "radius_secret_2": null,
                    "ssid": "PolkaSpots Supafly WiFi",
                    "encryption_type": "psk2",
                    "encryption_key": "superblue123",
                    "ssid_disabled": false,
                    "ssid_hidden": false,
                    "dhcp_enabled": true,
                    "dhcp_relay_on": true,
                    "config_type_bridge": false,
                    "bridge_to_switch_ports": false,
                    "make_part_of_lan": false,
                    "captive_portal_enabled": true,
                    "radius_8021x_host_1": null,
                    "radius_8021x_secret_1": null,
                    "radius_8021x_port_1": 1812,
                    "radius_8021x_host_2": null,
                    "radius_8021x_secret_2": null,
                    "radius_8021x_port_2": 1812,
                    "radius_8021x_interval": null,
                    "access_type": "open",
                    "captive_portal_ps": true,
                    "use_ps_radius": true,
                    "proxy_server_host": null,
                    "proxy_server_port": null,
                    "dns_1": "8.8.8.8",
                    "dns_2": "8.8.4.4",
                    "vlan_id": null,
                    "zone_ids": []
                },
                {
                    "id": "54ee7b14726169703e2600",
                    "network_name": "private",
                    "description": "Secondary network",
                    "active": true,
                    "network_radio_mode": null,
                    "interface_ipaddr": "192.168.210.1",
                    "interface_netmask": "24",
                    "dhcp_start": 2,
                    "dhcp_end": 150,
                    "dhcp_lease": "12h",
                    "dhcp_limit": 100,
                    "captive_portal_url": "http://polkaspots.my-wifi.co/",
                    "captive_portal_port": 3990,
                    "captive_portal_uamsecret": null,
                    "captive_portal_allowed_hosts": null,
                    "captive_portal_allowed_macs": null,
                    "captive_portal_walledgardens": null,
                    "content_filter": "None",
                    "radius_host_1": "radius-1.polkaspots.co",
                    "radius_host_2": "radius-2.polkaspots.co",
                    "radius_secret_1": null,
                    "radius_secret_2": null,
                    "ssid": "Pumpy Pants",
                    "encryption_type": "psk",
                    "encryption_key": "xxx",
                    "ssid_disabled": null,
                    "ssid_hidden": null,
                    "dhcp_enabled": true,
                    "dhcp_relay_on": true,
                    "config_type_bridge": false,
                    "bridge_to_switch_ports": false,
                    "make_part_of_lan": false,
                    "captive_portal_enabled": false,
                    "radius_8021x_host_1": null,
                    "radius_8021x_secret_1": null,
                    "radius_8021x_port_1": 1812,
                    "radius_8021x_host_2": null,
                    "radius_8021x_secret_2": null,
                    "radius_8021x_port_2": 1812,
                    "radius_8021x_interval": null,
                    "access_type": "password",
                    "captive_portal_ps": true,
                    "use_ps_radius": true,
                    "proxy_server_host": null,
                    "proxy_server_port": null,
                    "dns_1": "8.8.8.8",
                    "dns_2": "8.8.4.4",
                    "vlan_id": null,
                    "zone_ids": []
                },
                {
                    "id": "54f228d17261690826000000",
                    "network_name": "lan_53365",
                    "description": null,
                    "active": true,
                    "network_radio_mode": null,
                    "interface_ipaddr": "192.168.36.1",
                    "interface_netmask": "24",
                    "dhcp_start": 100,
                    "dhcp_end": 250,
                    "dhcp_lease": "12h",
                    "dhcp_limit": 100,
                    "captive_portal_url": null,
                    "captive_portal_port": 3990,
                    "captive_portal_uamsecret": null,
                    "captive_portal_allowed_hosts": null,
                    "captive_portal_allowed_macs": null,
                    "captive_portal_walledgardens": null,
                    "content_filter": "Security",
                    "radius_host_1": "rad-1.polkaspots.com",
                    "radius_host_2": "rad-2.polkaspots.com",
                    "radius_secret_1": null,
                    "radius_secret_2": null,
                    "ssid": "Le Gaff Wi-Fi",
                    "encryption_type": "psk2",
                    "encryption_key": "xxx",
                    "ssid_disabled": null,
                    "ssid_hidden": null,
                    "dhcp_enabled": true,
                    "dhcp_relay_on": true,
                    "config_type_bridge": false,
                    "bridge_to_switch_ports": false,
                    "make_part_of_lan": false,
                    "captive_portal_enabled": false,
                    "radius_8021x_host_1": null,
                    "radius_8021x_secret_1": null,
                    "radius_8021x_port_1": 1812,
                    "radius_8021x_host_2": null,
                    "radius_8021x_secret_2": null,
                    "radius_8021x_port_2": 1812,
                    "radius_8021x_interval": null,
                    "access_type": "password",
                    "captive_portal_ps": true,
                    "use_ps_radius": true,
                    "proxy_server_host": null,
                    "proxy_server_port": null,
                    "dns_1": "8.8.8.8",
                    "dns_2": "8.8.4.4",
                    "vlan_id": null,
                    "zone_ids": []
                }
            ]

### Create a new network [POST]

In order to create a network, there are a required set of parameters including the SSID or network name, an encryption_key if you set the network to password protected. Encryption can be open or PSK2. If you're using radius authentication 802.1x, we will set this attribute for you.

Remember you can create up to 16 networks. We will respond with the network object.

For information how to add this network to a zone, please see the Zones API.

+ Request (application/json)

    + Headers
    
            Accept: application/json
    
    + Body
    
            {   
                "location_id": "derby-council",
                "id": 54ee7b1470353c2600,
                network: {
                    description: 'A new description',
                    ssid: 'PolkaSpots WiFi',
                    encryption_type: 'psk2',
                    encryption_key: 'SecurePassy123'
                }
            }

## Network Object [/api/v1/locations/{location_id}/networks/{id}]

Represents the individual network. Please note, some fields are currently read only.

### View a Network [GET]

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, integer, `1`) ... ID of the network you wish to update.

+ Request (application/json)

    + Headers
    
            Accept: application/json
    
    + Body
    
            {   
                "location_id": "derby-council",
                "id": 54ee7b1470353c2600
            }

+ Response 200 (application/json)

    + Body
    
            {
                "id": "54ee7b1470353c2600",
                "network_name": "public",
                "description": "Primary network",
                "active": true,
                "network_radio_mode": null,
                "interface_ipaddr": "192.168.4.1",
                "interface_netmask": "24",
                "dhcp_start": 100,
                "dhcp_end": 250,
                "dhcp_lease": "12h",
                "dhcp_limit": 100,
                "captive_portal_url": "http://polkaspots.my-wifi.co/",
                "captive_portal_port": 3990,
                "captive_portal_uamsecret": "3a0e4927c8891d0704cfd006947eb8e3",
                "captive_portal_allowed_hosts": "8.8.8.8,208.67.222.222,208.67.220.220",
                "captive_portal_allowed_macs": "",
                "captive_portal_walledgardens": null,
                "content_filter": "Security",
                "radius_host_1": "cluster-1.polkaspots.co",
                "radius_host_2": "cluster-2.polkaspots.co",
                "radius_secret_1": null,
                "radius_secret_2": null,
                "ssid": "PolkaSpots Supafly WiFi",
                "encryption_type": "psk2",
                "encryption_key": "superblue123",
                "ssid_disabled": false,
                "ssid_hidden": false,
                "dhcp_enabled": true,
                "dhcp_relay_on": true,
                "config_type_bridge": false,
                "bridge_to_switch_ports": false,
                "make_part_of_lan": false,
                "captive_portal_enabled": true,
                "radius_8021x_host_1": null,
                "radius_8021x_secret_1": null,
                "radius_8021x_port_1": 1812,
                "radius_8021x_host_2": null,
                "radius_8021x_secret_2": null,
                "radius_8021x_port_2": 1812,
                "radius_8021x_interval": null,
                "access_type": "open",
                "captive_portal_ps": true,
                "use_ps_radius": true,
                "proxy_server_host": null,
                "proxy_server_port": null,
                "dns_1": "8.8.8.8",
                "dns_2": "8.8.4.4",
                "vlan_id": null,
                "zone_ids": [],
                "job_id": null
            }

### Update a Network [GET]

You have four options for content filtering / DNS. If you pass one of the three options with the content filter, your DNS settings will be overriden:

- Security
- Family
- Danger
- Adult

These are case insenstive.

If you want to set your own DNS, please pass 'None' as a content filtering parameter. If you set the DNS to nil values, they will be reset to 8.8.8.8 and 8.8.4.4

If you want to cancel the sync after you create the network (or update it), you can send the param cancel_sync=true. Equally, if you want to resync all your devices, you can send the parameter sync=true.

Sync takes please 60 seconds after you create / destroy a network to give you time to cancel things. However, if you request a sync, this will take place immediately.

You can tell if there is a current job waiting to be processed by checking the job_id param. If this is set, a job will be run in less than 60s.

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, integer, `1`) ... ID of the network you wish to update.

+ Request (application/json)

    + Headers
    
            Accept: application/json
    
    + Body
    
            {   
                "location_id": "derby-council",
                "id": 54ee7b1470353c2600,
                network: {
                    description: 'A new description'
                }
            }

+ Response 200 (application/json)

    + Body
    
            {
                "id": "54ee7b1470353c2600",
                "network_name": "public",
                "description": "Primary network",
                "active": true,
                "network_radio_mode": null,
                "interface_ipaddr": "192.168.4.1",
                "interface_netmask": "24",
                "dhcp_start": 100,
                "dhcp_end": 250,
                "dhcp_lease": "12h",
                "dhcp_limit": 100,
                "captive_portal_url": "http://polkaspots.my-wifi.co/",
                "captive_portal_port": 3990,
                "captive_portal_uamsecret": "3a0e4927c8891d0704cfd006947eb8e3",
                "captive_portal_allowed_hosts": "8.8.8.8,208.67.222.222,208.67.220.220",
                "captive_portal_allowed_macs": "",
                "captive_portal_walledgardens": null,
                "content_filter": "Security",
                "radius_host_1": "cluster-1.polkaspots.co",
                "radius_host_2": "cluster-2.polkaspots.co",
                "radius_secret_1": null,
                "radius_secret_2": null,
                "ssid": "PolkaSpots Supafly WiFi",
                "encryption_type": "psk2",
                "encryption_key": "superblue123",
                "ssid_disabled": false,
                "ssid_hidden": false,
                "dhcp_enabled": true,
                "dhcp_relay_on": true,
                "config_type_bridge": false,
                "bridge_to_switch_ports": false,
                "make_part_of_lan": false,
                "captive_portal_enabled": true,
                "radius_8021x_host_1": null,
                "radius_8021x_secret_1": null,
                "radius_8021x_port_1": 1812,
                "radius_8021x_host_2": null,
                "radius_8021x_secret_2": null,
                "radius_8021x_port_2": 1812,
                "radius_8021x_interval": null,
                "access_type": "open",
                "captive_portal_ps": true,
                "use_ps_radius": true,
                "proxy_server_host": null,
                "proxy_server_port": null,
                "dns_1": "8.8.8.8",
                "dns_2": "8.8.4.4",
                "vlan_id": null,
                "zone_ids": [],
                "job_id": null
            }
            
### Delete a network [DELETE]

After deleting a network, we will send a sync event to the boxes to save the changes. This will occur 60 seconds after the network was deleted and will cause the users to disconnect.

+ Parameters

    + location_id (required, string, `le-gaff`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, string, `7281919179187298712`) ... ID of the network to perform action with. Has example value.

+ Request (application/json)

        {   
            "location_id": "derby-council",
            "id": "7281919179187298712",
        }

+ Response 204 (application/json)

# Group Payloads

Payloads are commands which run remotely on boxes. You must specify a valid command's unique id / slug for them to run.

There's several ways to run command on a box and you can run payloads on multiple boxes at a time.

Commands are usually run on boxes directly using the nested payloads resource. However, if you want to run on multiple boxes, you may send in box_ids as an array. More information in a moment.

Use the Commands API to get a list of commands.

Popular Payloads include rebooting a box, disabling login screens and running firmware updates.

You can:

- Run a single command on a box.
- Run a single command on many boxes.
- Run a firmware update on a single box.
- Run a firmware update on many boxes.
- Schedule a firmware update to run on a single box.
- Schedule a firmware update to run on many boxes.

The available options include:

- `POST` - Creates or updates a resource
- `GET` - Retrieves a resource or list of resources
- `DELETE` - Delete a resource

Optionally, you can choose to save the output of a command in a BLOB >!*. Just send the **save** parameter with your POST request.

If you are upgrading a box, you can send the version of the firmware you want to upgrade to and also the time you want the payload to run. Please note that if you upgrade a single device, the upgrade will run immediately. However, if you upgrade more than one box in one go, we will queue the job for processing. Jobs usually get processed within 30 seconds.

## Payloads collection [/api/v1/boxes/{box_id}/payloads]

### List payloads [GET]

+ Parameters

    + box_id (required, string, `ABCDEF`) ... Slug / ID of the box you want to request payloads for. Has example value.

    
+ Response 200 (application/json)
    
    + Body
    
            [{
                "created_at": "April 5 2014 23:34:42",
                "body": "[ 0.000000] Linux version 3.3.8
            },
            {
                "created_at": "May2201323: 22: 22",
                "body": "rebootedat9am"
            },
            {
                "created_at": "Jan5201403: 34: 28",
                "body": "No output"
            }]

## View a Payload [/api/v1/boxes/{box_id}/payloads/{id}]

### Get a payload [GET]

+ Parameters

    + id (required, integer, `123`) ... ID of the payload you want to view. Has example value.
    + box_id (array / string, `BMBCKJHS`) ... The slugs of the device you want to view payload for.


+ Request (application/json)

        { "id": "123" }

+ Response 200 (application/json)

    + Body
    
            {
                "created_at": "April 5 2014 23:34:22",
                "body": "uptime 12 days, 1 min, load 1 2 3"
            }

## Create payload a box [/api/v1/boxes/{box_id}/payloads{?command_id,box_ids,upgrade,scheduled}]

### Send a payload [POST]

If you pass in an array of box ids, your payload will not run on the box you're using to authorise the request. In this case, the box with {id}.

As previously mentioned, upgrading a single box will occur immediately and you'll get an email notification thereafter. If you upgrade multiple boxes, we queue the job.

+ Parameters

    + box_id (required, string, `ZOWso8IMhuwYTrdh`) ... Slug `slug` of the Box to perform action with. Has example value.
    + command_id (string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Unique ID of the command you want to send to the box.
    + box_ids (array / string, `HSKJHKJH,BMBCKJHS`) ... The slugs of the devices you want to receive the payloads.
    + upgrade (boolean `true`) ... Send a true value and we will upgrade all the boxes you have sent and ignore the command.
    + scheduled (string `12am tomorrow`) ... Send the time you want the upgrade to occur. Applies to upgrades only.

+ Request (application/json)

        { "payload":
                {
                    "command_id": "JCyK7Zwh0ON_ZOWso8Mhuw",
                    "box_ids": ['ID', 'ID2', 'ID3'],
                    "upgrade": true,
                    "scheduled": "Tonight at 4pm",
                }
        }

+ Response 201 (application/json)

        { message: "Device payload initiated." }

+ Response 422 (application/json)

        { status: "unprocessable_entity" }

# Group Port Forwards

Port Forwards related resources of the **Port Forwards API**. Networks are a nested in a box and are not accessible anywhere else. 

You may create and update the port forwards directly or as a nested resource within a box.

Port forwarding is a way to make the devices within your network accessible to computers on the Internet.

Use port forwards to allow access to your tills, CCTV systems and more.

**Please Note**

Adding, removing and updating port forwards will cause your boxes to sync. This may mean you and your clients lose connectivity.

##Allowed HTTPs requests:

- `POST` - Creates a resource
- `PATCH` - Updates a resource
- `GET` - Retrieves a resource or list of resources
- `DELETE` - Delete a resource

## Port Forwards Collection [/api/v1/boxes/{box_id}/port_forwards]

### List all port forwards for a box [GET]

+ Parameters

    + box_id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the Box to perform action with. Has example value.

+ Response 200 (application/json)

    + Body
    
            [{
                "id": 7,
                "unique_id": "1815463621122310719",
                "source": "1.2.3.4/16",
                "destination_port": 80,
                "destination_ip": "",
                "target": "",
                "forward_to_ip": "1.1.2.9",
                "forward_to_port": 443
            },
            {
                "id": 12,
                "unique_id": "7272729879261726817",
                "source": "12.1.2.3/232",
                "destination_port": 80,
                "destination_ip": "",
                "target": "",
                "forward_to_ip": "1.2.3.4",
                "forward_to_port": 22
            },
            {
                "id": 13,
                "unique_id": "7281919179187298712",
                "source": "1.2.3.4/232",
                "destination_port": 23,
                "destination_ip": "",
                "target": "",
                "forward_to_ip": "12.12.12.12",
                "forward_to_port": 2223
            }]
        
## Port Forward Item [/api/v1/boxes/{box_id}/port_forwards/{unique_id}]

Get a single port forward item.

### Get a single port forward for a box [GET]

+ Parameters

    + box_id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the Box to perform action with. Has example value.
    + unique_id (required, string, `7281919179187298712`) ... Unique ID of the port forward to perform action with. Has example value.

+ Response 200 (application/json)

    + Body
                    
            {
                "id": 7,
                "unique_id": "1815463621122310719",
                "source": "1.2.3.4/16",
                "destination_port": 80,
                "destination_ip": "",
                "target": "",
                "forward_to_ip": "1.1.2.9",
                "forward_to_port": 22
            }

## Create a Port Forward Item [/api/v1/boxes/{box_id}/port_forwards{?port_forward}]

### Create a single port forward item [PATCH]

Please note, source, forward_to_ip, forward_to_port and destination_port are all required and are validated fields.

- Source must be a valid IP in CIDR notation - 10.10.0.1/16
- forward_to_ip must be a valid IP - 10.1.1.1
- destination_port and forward_to_port must be numeric and between 1 - 64322

Please use the Unique Id to update a port forward.

+ Parameters

    + box_id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the Box to perform action with. Has example value.
    + port_forward (required, params, `source=10.1.2.3/12`) ... Params hash containing values you wish to update.

+ Request (application/json)

        { "port_forward":
                {
                    "source": "1.2.3.4/16",
                    "destination_port": 80,
                    "destination_ip": "",
                    "target": "",
                    "forward_to_ip": "192.168.4.3",
                    "forward_to_port": 22
                }
        }

+ Response 201 (application/json)

    + Body
                    
            {
                "id": 7,
                "unique_id": "1815463621122310719",
                "source": "1.2.3.4/16",
                "destination_port": 80,
                "destination_ip": "",
                "target": "",
                "forward_to_ip": "192.168.4.3",
                "forward_to_port": 22
            }
            
## Modify a Port Forward Item [/api/v1/boxes/{box_id}/port_forwards/{unique_id}{?port_forward}]

### Update a single port forward item [PATCH]

Please note, source, forward_to_ip, forward_to_port and destination_port are all required and are validated fields.

- Source must be a valid IP in CIDR notation - 10.10.0.1/16
- forward_to_ip must be a valid IP - 10.1.1.1
- destination_port and forward_to_port must be numeric and between 1 - 64322

Please use the Unique Id to update a port forward.

+ Parameters

    + box_id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the Box to perform action with. Has example value.
    + unique_id (required, string, `7281919179187298712`) ... Unique ID of the port forward to perform action with. Has example value.
    + port_forward (required, params, `source=10.1.2.3/12`) ... Params hash containing values you wish to update.

+ Request (application/json)

        { "port_forward":
                {
                    "source": "1.2.3.4/16",
                    "destination_port": 80,
                    "destination_ip": "",
                    "target": "",
                    "forward_to_ip": "192.168.4.3",
                    "forward_to_port": 22
                }
        }

+ Response 201 (application/json)

    + Body
                    
            {
                "id": 7,
                "unique_id": "1815463621122310719",
                "source": "1.2.3.4/16",
                "destination_port": 80,
                "destination_ip": "",
                "target": "",
                "forward_to_ip": "192.168.4.3",
                "forward_to_port": 22
            }
            
### Delete a port forward [DELETE]

+ Parameters

    + box_id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the Box to perform action with. Has example value.
    + unique_id (required, string, `7281919179187298712`) ... Unique ID of the port forward to perform action with. Has example value.

+ Request (application/json)

        {   
            "box_id": "JCyK7Zwh0ON_ZOWso8Mhuw",
            "unique_id": "7281919179187298712",
        }

+ Response 204 (application/json)

# Group Speedtests

Speedtests belong to boxes and are a nested resource. You can only create and list speedtests per device. Creating a speedtest **DOES NOT** store it permanently. Only speedtests which run automatically in the middle of the night are stored.

The creation of a speedtest is meant to be an ephemeral and quick connection check. The results from the creation of a speedtest can be seen in the Box object. Use the Boxes API to get this information.

##Allowed HTTPs requests:

- `POST` - Creates or updates a resource
- `GET` - Retrieves a list of speedtests

## Speedtests Collection [/api/v1/boxes/{box_id}/speedtests]

+ Parameters

    + box_id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the Box to perform action with. Has example value.

### List all Speedtests [GET]

+ Request (application/json)

            { "box_id": "JCyK7Zwh0ON_ZOWso8Mhuw" }

+ Response 200 (application/json)


    + Body

            [{
                "download_speed": "1680.0",
                "created_at": "September 30 2014 00:59:57",
                "box_id": 2217
            },
            {
                "download_speed": "2236.0",
                "created_at": "September 29 2014 00:59:57",
                "box_id": 2217
            },
            {
                "download_speed": "783732.0",
                "created_at": "September 28 2014 00:59:57",
                "box_id": 2217
            },
            {
                "download_speed": "1190397.0",
                "created_at": "September 27 2014 00:59:57",
                "box_id": 2217
            },
            {
                "download_speed": "1067134.0",
                "created_at": "September 26 2014 00:59:58",
                "box_id": 2217
            },
            {
                "download_speed": "987708.0",
                "created_at": "September 25 2014 00:59:58",
                "box_id": 2217
            },
            {
                "download_speed": "819041.0",
                "created_at": "September 24 2014 00:59:58",
                "box_id": 2217
            },
            {
                "download_speed": "0.0",
                "created_at": "September 23 2014 00:59:58",
                "box_id": 2217
            },
            {
                "download_speed": "0.0",
                "created_at": "September 22 2014 00:59:58",
                "box_id": 2217
            },
            {
                "download_speed": "0.0",
                "created_at": "September 21 2014 00:59:58",
                "box_id": 2217
            }]


### Create a Speedtest [POST]

You can't run two speedtests at the same time. You will receieve a 422 response if you try before the speedtest has completed.

Speedtests are queued - should a job fail, we'll pause for 120 seconds before allowing another one to run.

Remember, creating a speedtest only creates a temporary result. Permanent results are collected at the same time daily.

+ Parameters

    + box_id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the Box to perform action with. Has example value.

+ Request (application/json)

            { "box_id": "JCyK7Zwh0ON_ZOWso8Mhuw" }

+ Response 200 (application/json)

            { "message": "Speedtest queued for processing." }

# Group Sessions

Depreciated. This will be removed soon.

Sessions API provides information on the individual logins per location, box, etc.

Supports:

- `GET` - Retrieves a resource or list of resources

You may query the data and we have some marginally non-restful resources which offer some filtered and aggregated data. More later.

Can be called on the root resource alone /api/v1/sessions or within a location or box:

- /api/v1/sessions
- /api/v1/locations/{id}/sessions
- /api/v1/boxes/{id}/sessions

All sessions queries are cached for ten minutes from the initial request unless a search parameter is passed.

**Please note, we do not provide the mac address of the end-user's device. Intead you can find a unique_id which is a hashed digest of the mac.**

## Sessions Collection [/api/v1/sessions{?q,location_id,box_id,page,size}]

Limited to 1,000 records per query. Pagination is available.

Alongside the standard fields, you will see some fields for pagination:

- _current_page
- _next_page
- _total_pages

#### Fields to filter include:

- username

##Allowed HTTPs requests:

- `GET` - Retrieves a resource or list of resources

### List all sessions [GET]

+ Parameters

    + box_id (optional, integer, `153`) ... The numeric ID of the box you want to filter results for.
    + location_id (optional, integer, `872`) ... The numeric ID of the location you want to filter results for.
    + page (optional, integer, `1`) ... For pagination purposes. 
    + size (optional, integer, `500`) ... The number of records you want to return. Max. value is 1000.
    + q (optional, string, `search query`) ... Search through the results as you query the API.

+ Response 200 (application/json)

    + Body
        
            {
                "sessions": [
                    {
                        "id": 4297722,
                        "unique_id": "97bcdd704e5177d6f463c695c2e88ee2",
                        "acctsessionid": "603482350068250588",
                        "acctuniqueid": "12465ea6b5e6594e",
                        "username": "7537d8d5-c6dc-44bf-aee8-4a1bbc11521e",
                        "groupname": "",
                        "realm": "",
                        "ap_ipaddr": "10.241.87.150",
                        "device_ipaddr": "46.165.249.9",
                        "ap_mac": "00-18-0A-04-4B-1C",
                        "starttime": "2014-08-14T22:17:20.000+01:00",
                        "stoptime": "2014-08-14T22:52:17.000+01:00",
                        "sessiontime": 2086,
                        "stopcause": "Idle-Timeout",
                        "download": 593920,
                        "upload": 3482624,
                        "hour": 22,
                        "date": "2014-08-14",
                        "manufacturer": "Motorola Mobility LLC",
                        "location_id": 870,
                        "lat": 0.142222,
                        "lng": 71.8878
                    },
                    {
                        "id": 4297579,
                        "unique_id": "2346f71f291b41c5d9d8824bd22f5cee",
                        "acctsessionid": "603482350068250406",
                        "acctuniqueid": "fb8e7856e06cd28c",
                        "username": "70a813bb-161d-4023-a416-3fbbf7c39b65",
                        "groupname": "",
                        "realm": "",
                        "ap_ipaddr": "10.230.190.83",
                        "device_ipaddr": "46.165.249.9",
                        "ap_mac": "00-18-0A-04-5D-42",
                        "starttime": "2014-08-14T21:15:55.000+01:00",
                        "stoptime": "2014-08-14T21:47:17.000+01:00",
                        "sessiontime": 1861,
                        "stopcause": "Idle-Timeout",
                        "download": 112640,
                        "upload": 1657856,
                        "hour": 21,
                        "date": "2014-08-14",
                        "manufacturer": "Samsung Electronics Co.,Ltd",
                        "location_id": 870,
                        "lat": 0.142222,
                        "lng": 71.8878
                    },
                    {
                        "id": 4297505,
                        "unique_id": "878f4db6727337ff24512212facc7385",
                        "acctsessionid": "603482350068250265",
                        "acctuniqueid": "58d016913c6f89f3",
                        "username": "befbfd4e-2b76-40c1-a685-fe449a1d27a8",
                        "groupname": "",
                        "realm": "",
                        "ap_ipaddr": "10.241.202.251",
                        "device_ipaddr": "46.165.249.9",
                        "ap_mac": "00-18-0A-04-5D-42",
                        "starttime": "2014-08-14T20:39:19.000+01:00",
                        "stoptime": "2014-08-14T21:29:18.000+01:00",
                        "sessiontime": 3001,
                        "stopcause": "Idle-Timeout",
                        "download": 1801216,
                        "upload": 14817280,
                        "hour": 20,
                        "date": "2014-08-14",
                        "manufacturer": "Sony Mobile Communications AB",
                        "location_id": 870,
                        "lat": 0.142222,
                        "lng": 71.8878
                    },
                    {
                        "id": 4296323,
                        "unique_id": "c5f591088de5e75498d5e35d7aecc800",
                        "acctsessionid": "53ecdbc700000005",
                        "acctuniqueid": "bad3d725acd9faed",
                        "username": "74a7e839-d2a2-468c-aa1d-dc662771fb67",
                        "groupname": "",
                        "realm": "",
                        "ap_ipaddr": "192.168.4.85",
                        "device_ipaddr": "192.168.4.1",
                        "ap_mac": "DC-9F-DB-33-5B-4B",
                        "starttime": "2014-08-14T18:39:42.000+01:00",
                        "stoptime": "2014-08-14T18:59:52.000+01:00",
                        "sessiontime": 1210,
                        "stopcause": "0",
                        "download": 1066281,
                        "upload": 321456,
                        "hour": 18,
                        "date": "2014-08-14",
                        "manufacturer": "Samsung Electronics Co.,Ltd",
                        "location_id": 154,
                        "lat": 0.142222,
                        "lng": 71.8878
                    },
                    {
                        "id": 4293749,
                        "unique_id": "253adc21c5d63e07ed0102af45678a8b",
                        "acctsessionid": "603482350068249182",
                        "acctuniqueid": "b57077dcbc7531da",
                        "username": "26b1d67f-293a-429e-95e4-5522927e0357",
                        "groupname": "",
                        "realm": "",
                        "ap_ipaddr": "10.62.220.2",
                        "device_ipaddr": "46.165.249.9",
                        "ap_mac": "00-18-0A-04-4B-1C",
                        "starttime": "2014-08-14T16:01:13.000+01:00",
                        "stoptime": "2014-08-14T16:48:47.000+01:00",
                        "sessiontime": 2846,
                        "stopcause": "Idle-Timeout",
                        "download": 393216,
                        "upload": 6594560,
                        "hour": 16,
                        "date": "2014-08-14",
                        "manufacturer": "Apple",
                        "location_id": 870,
                        "lat": 0.142222,
                        "lng": 71.8878
                    },
                ],
                "_links": {
                    "current_page": 1,
                    "total_pages": 18521,
                    "next_page": 2,
                    "total_entries": 463003
                }
            }

## Sessions Timeline [/api/v1/sessions{?timeline,start,end}]

Returns the aggregated sessions per day for the specified range.

### Sessions timeline aggregate [GET]

+ Parameters

    + timeline (required, boolean, `true`) ... Using timeline = true to provide timeline aggregates.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 12 weeks ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to 12 weeks ago.


+ Response 200 (application/json)

    + Body
    
            {        
                "timeline": [
                    {
                        "time": 1406332800000,
                        "count": 12210
                    },
                    {
                        "time": 1406419200000,
                        "count": 9445
                    },
                    {
                        "time": 1406505600000,
                        "count": 14473
                    },
                    {
                        "time": 1406592000000,
                        "count": 17580
                    },
                    {
                        "time": 1406678400000,
                        "count": 19443
                    },
                    {
                        "time": 1406764800000,
                        "count": 31008
                    },
                    {
                        "time": 1406851200000,
                        "count": 38870
                    },
                    {
                        "time": 1406937600000,
                        "count": 10262
                    },
                    {
                        "time": 1407024000000,
                        "count": 7399
                    },
                    {
                        "time": 1407110400000,
                        "count": 10590
                    },
                    {
                        "time": 1407974400000,
                        "count": 25678
                    }
                ]
            }
            
## Uniques Timeline [/api/v1/{?uniques_timeline,interval,start,end}]

Returns aggregated data for the unique users by mac address (not provided) on a daily basis.

### Uniques timeline [GET]

+ Parameters

    + uniques_timeline (required, boolean, `true`) ... Using uniques_timeline = true to provide a unique users per day, week, month.
    + interval (optional, string, `week`) ... Set the interval for the query. Options include day, week or month. Leave blank and results are grouped daily.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 12 weeks ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to now.

+ Response 200 (application/json)

    + Body
            
            {
                "uniques_timeline": [
                    {
                        "time": 1406329200000,
                        "count": 1680
                    },
                    {
                        "time": 1406415600000,
                        "count": 1376
                    },
                    {
                        "time": 1406502000000,
                        "count": 2042
                    },
                    {
                        "time": 1406588400000,
                        "count": 2257
                    },
                    {
                        "time": 1406674800000,
                        "count": 2170
                    },
                    {
                        "time": 1406761200000,
                        "count": 2225
                    },
                    {
                        "time": 1406847600000,
                        "count": 2235
                    },
                    {
                        "time": 1406934000000,
                        "count": 1613
                    },
                    {
                        "time": 1408057200000,
                        "count": 29
                    }
                ]
            }

## Who's Online [/api/v1/sessions{?online,page,size}]

Returns a list of users currently connected and logged in. This table is cleared every five minutes. During this time, you may see a non-blank stoptime. This will mean the user has disconnected and will be accompanied by a stopreason.

A _links object is also available with the pagination details.

### List online [GET]

+ Parameters

    + online (required, boolean, `true`) ... Using online = true to provide a list of online users.
    + page (optional, integer, `1`) ... For pagination purposes. 
    + size (optional, integer, `500`) ... The number of records you want to return. Max. value is 1000.

+ Response 200 (application/json)

    + Body

            {
                "online": [
                    {
                        "ap_mac": "00:11:22:33:44:55",
                        "unique_id": "e8840311f8054efb51edae464bff66e2",
                        "starttime": "2014-08-14T11:31:46.000+01:00",
                        "stoptime": null,
                        "stopreason": null,
                        "location_id": 11,
                        "download": 981273987,
                        "upload": 1231232
                    },
                    {
                        "ap_mac": "00:11:22:33:44:55",
                        "unique_id": "a06f0133050966f39e52ef50410ab487",
                        "starttime": "2014-08-14T11:14:28.000+01:00",
                        "stoptime": null,
                        "stopreason": null,
                        "location_id": 0,
                        "download": 9919191,
                        "upload": 817266
                    },
                    {
                        "ap_mac": "00:11:22:33:44:55",
                        "unique_id": "e8840311f8054efb51edae464bff66e2",
                        "starttime": "2014-08-14T11:31:41.000+01:00",
                        "stoptime": null,
                        "stopreason": null,
                        "location_id": 28,
                        "download": 82398723,
                        "upload": 283749
                    },
                    {
                        "ap_mac": "00:11:22:33:44:55",
                        "unique_id": "bb10c2c4d6ff9ccec57481e8a8ac3c33",
                        "starttime": "2014-08-15T00:23:16.000+01:00",
                        "stoptime": null,
                        "stopreason": "Idle-Timeout",
                        "location_id": 99,
                        "download": 34534534,
                        "upload": 89739487
                    }
                ],
                "_links": {
                    "current_page": 1,
                    "total_pages": 2,
                    "next_page": 2,
                    "total_entries": 42
                }
            }

## Client aggregates [/api/v1/sessions{?clients,page,size}]

An aggregated list of clients with session data grouped by their unique id.

If the client is currently online, the online parameter will be set to true.

A _links object is also available with the pagination details.

### List clients [GET]

+ Parameters

    + clients (required, boolean, `true`) ... Using clients = true to provide a list of clients.
    + page (optional, integer, `1`) ... For pagination purposes. 
    + size (optional, integer, `500`) ... The number of records you want to return. Max. value is 1000.

+ Response 200 (application/json)

    + Body

            {
                "clients": [
                    {
                        "unique_id": "324f726a19920f9c50e1603ce5be7a1d",
                        "username": "2f969274b6d034c6cb03f2e62359f971643d3d51",
                        "last_seen": "2014-07-26T11:29:06.000+01:00",
                        "count": 1,
                        "manufacturer": "Apple",
                        "downloads": 231074,
                        "online": false
                    },
                    {
                        "unique_id": "a7eb678617ddf92744c8a3d317e4ff98",
                        "username": "784ffefc-74c4-44b0-b769-7b0e1fd1e5c7",
                        "last_seen": "2014-07-26T11:22:36.000+01:00",
                        "count": 2,
                        "manufacturer": "Murata Manufactuaring Co.,Ltd.",
                        "downloads": 0,
                        "online": false
                    },
                    {
                        "unique_id": "9907d8ed918ff118a06dfa0fd23ca7e5",
                        "username": "4db35152-f2b9-4930-a010-1559a418993a",
                        "last_seen": "2014-07-26T10:35:34.000+01:00",
                        "count": 23,
                        "manufacturer": "Apple",
                        "downloads": 5907801,
                        "online": false
                    }
                ],
                "_links": {
                    "current_page": 1,
                    "total_pages": 1,
                    "next_page": null,
                    "total_entries": 10
                }
            }


## Unique clients [/api/v1/sessions{?uniques,start,end,interval}]

Returns the aggregated unique clients for the specified range.

### Unique clients aggregate [GET]

+ Parameters

    + uniques (required, boolean, `true`) ... Using uniques = true to provide unique client aggregates.
    + interval (optional, string, `week`) ... Set the interval for the query. Options include day, week or month. Leave blank and results are grouped daily.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 12 weeks ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to today.


+ Response 200 (application/json)

    + Body

            {
                "uniques": {
                    "_type": "terms",
                    "missing": 0,
                    "total": 483442,
                    "other": 465273,
                    "terms": [
                        {
                            "term": "5d1614670b13a11762f97b9f0d0ec247",
                            "count": 2192
                        },
                        {
                            "term": "e64995d427e856aedf54c6098250d085",
                            "count": 2126
                        },
                        {
                            "term": "68e6b8941e05cefbca7b09b24e0f3d48",
                            "count": 2087
                        },
                        {
                            "term": "7f90d57fe9b94f2a3b16af582bedbad8",
                            "count": 2001
                        },
                        {
                            "term": "bf1bf04c73a3337ac9c3088df62e415e",
                            "count": 1977
                        },
                        {
                            "term": "f89928645900cbd226d0db5d3a198399",
                            "count": 1777
                        },
                        {
                            "term": "63fcc15ce2536ac4cc75b370e8b7903c",
                            "count": 1739
                        },
                        {
                            "term": "b95f55a51a4434db2426cacdf713541b",
                            "count": 1665
                        },
                        {
                            "term": "7a22cb356c155319150ceabf2b88a603",
                            "count": 1660
                        },
                        {
                            "term": "1e9bd1869e99b33f7e7860c58630f353",
                            "count": 945
                        }
                    ]
                }
            }
        

## Top Boxes [/api/v1/sessions{?boxes,start,end}]

Returns the aggregated sessions per box in your network.

### Top boxes aggregates [GET]

+ Parameters

    + boxes (required, boolean, `true`) ... Using boxes = true to provide unique box session aggregates.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 12 weeks ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to 12 weeks ago.


+ Response 200 (application/json)

    + Body

            {
                "boxes": {
                    "_type": "terms",
                    "missing": 0,
                    "total": 483442,
                    "other": 389931,
                    "terms": [
                        {
                            "term": "00-27-22-54-DE-79",
                            "count": 16506
                        },
                        {
                            "term": "00-27-22-50-33-26",
                            "count": 15324
                        },
                        {
                            "term": "00-27-22-54-FF-D4",
                            "count": 11345
                        },
                        {
                            "term": "DC-9F-DB-B0-A1-36",
                            "count": 8604
                        },
                        {
                            "term": "00-25-22-2F-AF-65",
                            "count": 8265
                        },
                        {
                            "term": "DC-9F-DB-2A-33-D4",
                            "count": 7933
                        },
                        {
                            "term": "24-A4-3C-D2-41-6C",
                            "count": 6995
                        },
                        {
                            "term": "24-A4-3C-0E-00-DE",
                            "count": 6876
                        },
                        {
                            "term": "24-A4-3C-98-00-D6",
                            "count": 6609
                        },
                        {
                            "term": "00-27-22-50-12-2F",
                            "count": 5054
                        }
                    ]
                }
            }      
          
## Top Locations [/api/v1/sessions{?locations,start,end}]

Returns the aggregated sessions per location in your network.

The results will include a term field which is the ID of the location.

### Top locations aggregates [GET]

+ Parameters

    + locations (required, boolean, `true`) ... Using locations = true to provide location aggregates by session.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 12 weeks ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to 12 weeks ago.


+ Response 200 (application/json)

    + Body
             
             {
                "locations": [
                    {
                        "term": "46",
                        "count": 54427
                    },
                    {
                        "term": "1099",
                        "count": 28056
                    },
                    {
                        "term": "1170",
                        "count": 22318
                    },
                    {
                        "term": "800",
                        "count": 16718
                    },
                    {
                        "term": "1196",
                        "count": 8604
                    },
                    {
                        "term": "1853",
                        "count": 8491
                    },
                    {
                        "term": "24",
                        "count": 8300
                    },
                    {
                        "term": "471",
                        "count": 7933
                    },
                    {
                        "term": "1809",
                        "count": 6995
                    },
                    {
                        "term": "1870",
                        "count": 5312
                    }
                ]
            }
            
            
## Session stats [/api/v1/sessions{?stats,start,end}]

Returns statistical information on your sessions. Includes:

- Number of sessions
- Total minutes online
- Min, max and mean values
- Standard deviation and variance

### Session statistics [GET]

+ Parameters

    + stats (required, boolean, `true`) ... Using stats = true to provide session statistics.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 12 weeks ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to 12 weeks ago.


+ Response 200 (application/json)

    + Body

            {
                "stats": {
                    "_type": "statistical",
                    "count": 483442,
                    "total": 2033487829,
                    "min": 0,
                    "max": 488313,
                    "mean": 4206.270512284825,
                    "sum_of_squares": 78037412978587,
                    "variance": 143727713.1204451,
                    "std_deviation": 11988.649345128295
                }
            }
            
## Session data stats [/api/v1/sessions{?data,start,end}]

Returns statistical information on your sessions. Includes:

- Number of sessions
- Total data download and uploaded
- Min, max and mean values for data transfer
- Standard deviation and variance

### Session data statistics [GET]

+ Parameters

    + data (required, boolean, `true`) ... Using data = true to provide session data usage statistics.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 12 weeks ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to 12 weeks ago.


+ Response 200 (application/json)

    + Body

            {
                "data": {
                    "downloads": {
                        "_type": "statistical",
                        "count": 483442,
                        "total": 30615204960418,
                        "min": 0,
                        "max": 11766394118,
                        "mean": 63327565.58267176,
                        "sum_of_squares": 4.221603241186846e+22,
                        "variance": 83313501954548110,
                        "std_deviation": 288640783.5953681
                    },
                    "uploads": {
                        "_type": "statistical",
                        "count": 483442,
                        "total": 5204021009171,
                        "min": 0,
                        "max": 5613961670,
                        "mean": 10764519.857958142,
                        "sum_of_squares": 5.023311701172294e+21,
                        "variance": 10274847683233648,
                        "std_deviation": 101364923.33758087
                    }
                }
            }
            
    
## Top Manufacturers [/api/v1/sessions{?manufacturers,start,end}]

Returns the aggregated manufacturers in your network.

### Top boxes aggregates [GET]

+ Parameters

    + manufacturers (required, boolean, `true`) ... Using manufacturers = true to provide manufacturer aggregates.
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 12 weeks ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to 12 weeks ago.


+ Response 200 (application/json)

    + Body

            {
                "manufacturers": [
                    {
                        "term": "Apple",
                        "count": 1555378
                    },
                    {
                        "term": "Intel Corporate",
                        "count": 137411
                    },
                    {
                        "term": "Samsung Electronics Co.,Ltd",
                        "count": 125167
                    },
                    {
                        "term": "Hon Hai Precision Ind. Co.,Ltd.",
                        "count": 106136
                    },
                    {
                        "term": "HTC Corporation",
                        "count": 78125
                    },
                    {
                        "term": "Murata Manufactuaring Co.,Ltd.",
                        "count": 74703
                    },
                    {
                        "term": "Liteon Technology Corporation",
                        "count": 74142
                    },
                    {
                        "term": "Apple, Inc",
                        "count": 63293
                    },
                    {
                        "term": "Sony Mobile Communications AB",
                        "count": 51227
                    },
                    {
                        "term": "Apple, Inc.",
                        "count": 46957
                    }
                ]
            }

# Group Splash Pages

If you want to offer public Wi-Fi, splash pages are the most secure way to do so currently. We have already integrated our own splash page service but you can use this API to build your own.

Splash Page views count towards your monthly quota. You can view your quota using the Quota API.

You can have multiple splash pages per network and location. This allows you to offer different types of access:

- Periodic - different splash pages depending on the time
- Usage based -  control how much people are using
- Zones - each zone can have different splash pages
- Data - allow per MB users
- Weight - when one page has expired, roll back to another
- Tag based - for their party APs, offer access based on SSID / VLAN / tag

For more details on how the splash rules work, please consult with the standard documentation. It can get confusing when you mess up zones, networks etc. as the pages will not display.

Please also note that whitelists / blacklists and availablity is cached for 60 seconds. If you swap from periodic to unlimited, for example, you will notice a slight delay before you can view the page again.

For details on adding social logins, please also read the standard docs. We currently support Facebook, LinkedIn and Google+ for the splash pages. LinkedIn require you to use https.

You may also offer paid access via the API. For more details, please read through the Store API.

## Splash Pages Collection [/api/v1/locations/{location_id}/splash_pages]

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.

### List all Splash Pages [GET]

We send only the highlevel params with this request and we also provide the list of available access types. 

+ Request (application/json)

    + Headers
    
            Accept: application/json

+ Response (application/json)

    + Body
    
            {
                "splash_pages": [
                    {
                        "unique_id": "5534365650235",
                        "active": false,
                        "primary_access": "Password",
                        "secondary_access": null,
                        "passwd_auto_gen": false,
                        "access_restrict": "none",
                        "access_restrict_period": "daily",
                        "access_restrict_mins": 60,
                        "access_restrict_down": 2048,
                        "download_speed": 2048,
                        "upload_speed": 1024,
                        "weight": 100,
                        "shop_active": true,
                        "available_days": null,
                        "available_start": "00:00",
                        "available_end": "00:00",
                        "success_url": null,
                        "newsletter_active": false
                    },
                    {
                        "unique_id": "98688676162798",
                        "active": true,
                        "primary_access": "Clickthrough",
                        "secondary_access": null,
                        "passwd_auto_gen": false,
                        "access_restrict": "none",
                        "access_restrict_period": "daily",
                        "access_restrict_mins": 60,
                        "access_restrict_down": 2048,
                        "download_speed": 2048,
                        "upload_speed": 1024,
                        "weight": 100,
                        "shop_active": true,
                        "available_days": [
                            
                        ],
                        "available_start": "00:00",
                        "available_end": "00:00",
                        "success_url": null,
                        "newsletter_active": false
                    }
                ],
                "access_types": [
                    {
                        "id": 1,
                        "name": "Password"
                    },
                    {
                        "id": 2,
                        "name": "Vouchers"
                    },
                    {
                        "id": 3,
                        "name": "Clickthrough"
                    },
                    {
                        "id": 6,
                        "name": "Facebook"
                    },
                    {
                        "id": 7,
                        "name": "Social"
                    }
                ]
            }
            
### Create new splash page [GET]

A splash page must belong to a network otherwise we can display it to the end user. You can pass the network on create and or update. Simply pass the id of your network in with the network_ids param. NetworkIds must be an array.

The primary_access_id must correspond to the id of the access type you want to offer. We send an array of available access types with the splash pages collection.

We will respond with the full Splash Page Object.

+ Request (application/json)

    + Headers
    
            Accept: application/json

    + Body
    
            { 
                location_id: 'my-location'
                splash_page: 
                    {
                        primary_access_id: 1       
                    }
            }
            
+ Response (application/json)

    + Body
    
            {
                "splash_page": {
                    "unique_id": "36710012950163",
                    "active": true,
                    "location_id": 1813,
                    "networks": [
                        "54efa7654c697a44b2030000"
                    ],
                    "primary_access_id": 1,
                    "secondary_access": false,
                    "secondary_access_id": null,
                    "design_id": 1,
                    "passwd_change_day": null,
                    "passwd_auto_gen": false,
                    "passwd_change_email": null,
                    "success_url": null,
                    "fb_use_ps": true,
                    "fb_app_id": null,
                    "fb_link": null,
                    "fb_login_on": true,
                    "g_login_on": true,
                    "li_login_on": false,
                    "li_api_key": null,
                    "g_api_key": null,
                    "g_use_ps": true,
                    "g_page_id": null,
                    "li_use_ps": true,
                    "g_redirect_to_page": true,
                    "fb_redirect_to_page": true,
                    "fb_checkin": true,
                    "backup_vouchers": false,
                    "fb_page_id": null,
                    "fb_msg": true,
                    "access_restrict": "none",
                    "access_restrict_period": "daily",
                    "access_restrict_mins": 60,
                    "access_restrict_down": 2048,
                    "access_restrict_up": 1024,
                    "whitelisted": null,
                    "blacklisted": null,
                    "available_days": null,
                    "available_start": "00:00",
                    "available_end": "00:00",
                    "auto_login": false,
                    "auto_login_timeout": 0,
                    "skip_user_registration": false,
                    "download_speed": 2048,
                    "upload_speed": 1024,
                    "session_timeout": 60,
                    "idle_timeout": 60,
                    "simultaneous_use": 25,
                    "allow_registration": false,
                    "password": "concerning",
                    "weight": 100,
                    "logo_file_name": null,
                    "background_image_name": "https://d247kqobagyqjh.cloudfront.net/api/file/plDFnqvSKWHGn5i6zUqw",
                    "location_image_name": null,
                    "location_image_name_svg": null,
                    "header_image_name": null,
                    "header_image_name_svg": null,
                    "header_image_type": 1,
                    "header_text": "Welcome to Stuff got real",
                    "info": "This is a generic page, get designing!",
                    "info_two": null,
                    "address": "12 Hamilton Lane",
                    "error_message_text": null,
                    "website": null,
                    "facebook_name": null,
                    "twitter_name": null,
                    "google_name": null,
                    "linkedin_name": null,
                    "instagram_name": null,
                    "pinterest_name": null,
                    "container_width": "850px",
                    "container_text_align": "center",
                    "body_background_colour": "#ffffff",
                    "heading_text_colour": "#000000",
                    "body_text_colour": "#333333",
                    "border_colour": "#cccccc",
                    "link_colour": "#2b68b6",
                    "container_colour": "#ffffff",
                    "button_colour": "#ffffff",
                    "header_colour": "#FFFFFF",
                    "error_colour": "#ED561B",
                    "container_transparency": 0.8,
                    "container_float": "center",
                    "container_inner_width": "100%",
                    "bg_dimension": "full",
                    "words_position": "right",
                    "logo_position": "left",
                    "font_family": "\"Helvetica Neue\", Arial, Helvetica, sans-serif",
                    "body_font_size": "12px",
                    "heading_text_size": "18px",
                    "heading_2_text_size": "12px",
                    "heading_2_text_colour": "#000000",
                    "heading_3_text_size": "12px",
                    "heading_3_text_colour": "#000000",
                    "btn_text": "Login Now",
                    "btn_font_size": "18px",
                    "btn_font_colour": "#000000",
                    "welcome_text": null,
                    "welcome_timeout": null,
                    "show_welcome": false,
                    "shop_active": true,
                    "remove_registration_link": false,
                    "newsletter_active": false,
                    "newsletter_type": null,
                    "newsletter_api_token": null,
                    "newsletter_list_id": null,
                    "forgot_password_link": true
                },
                "access_types": [
                    {
                        "id": 1,
                        "name": "Password",
                        "description": null
                    },
                    {
                        "id": 2,
                        "name": "Vouchers",
                        "description": null
                    },
                    {
                        "id": 3,
                        "name": "Clickthrough",
                        "description": null
                    },
                    {
                        "id": 6,
                        "name": "Facebook",
                        "description": null
                    },
                    {
                        "id": 7,
                        "name": "Social",
                        "description": null
                    }
                ],
                "networks": [
                    {
                        "id": "54f22eeb4c697a2055030000",
                        "ssid": "Stuff got real Wi-Fi"
                    },
                    {
                        "id": "54f225844c697a2055000000",
                        "ssid": "Stuff got real Wi-Fi LAN "
                    },
                    {
                        "id": "54efa7654c697a44b2030000",
                        "ssid": "Bridge"
                    }
                ]
            }

## Splash Page Object [/api/v1/locations/{location_id}/splash_pages/{id}]

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, string, `54efa7654c697a44b2030000`) ... ID of the Splash Page to perform action with. Has example value.

### View a splash page [GET]

As you can see from the response, you can control the design and access types using this API. Even if you are using our hosted splash page service, you may update params here which will be sent to the login page your customers will see.

+ Request (application/json)

    + Headers
    
            Accept: application/json

+ Response (application/json)

    + Body
    
        {
            "splash_page": {
                "unique_id": "36710012950163",
                "active": true,
                "location_id": 1813,
                "networks": [
                    "54efa7654c697a44b2030000"
                ],
                "primary_access_id": 1,
                "secondary_access": false,
                "secondary_access_id": null,
                "design_id": 1,
                "passwd_change_day": null,
                "passwd_auto_gen": false,
                "passwd_change_email": null,
                "success_url": null,
                "fb_use_ps": true,
                "fb_app_id": null,
                "fb_link": null,
                "fb_login_on": true,
                "g_login_on": true,
                "li_login_on": false,
                "li_api_key": null,
                "g_api_key": null,
                "g_use_ps": true,
                "g_page_id": null,
                "li_use_ps": true,
                "g_redirect_to_page": true,
                "fb_redirect_to_page": true,
                "fb_checkin": true,
                "backup_vouchers": false,
                "fb_page_id": null,
                "fb_msg": true,
                "access_restrict": "none",
                "access_restrict_period": "daily",
                "access_restrict_mins": 60,
                "access_restrict_down": 2048,
                "access_restrict_up": 1024,
                "whitelisted": null,
                "blacklisted": null,
                "available_days": null,
                "available_start": "00:00",
                "available_end": "00:00",
                "auto_login": false,
                "auto_login_timeout": 0,
                "skip_user_registration": false,
                "download_speed": 2048,
                "upload_speed": 1024,
                "session_timeout": 60,
                "idle_timeout": 60,
                "simultaneous_use": 25,
                "allow_registration": false,
                "password": "concerning",
                "weight": 100,
                "logo_file_name": null,
                "background_image_name": "https://d247kqobagyqjh.cloudfront.net/api/file/plDFnqvSKWHGn5i6zUqw",
                "location_image_name": null,
                "location_image_name_svg": null,
                "header_image_name": null,
                "header_image_name_svg": null,
                "header_image_type": 1,
                "header_text": "Welcome to Stuff got real",
                "info": "This is a generic page, get designing!",
                "info_two": null,
                "address": "12 Barry Lane",
                "error_message_text": null,
                "website": null,
                "facebook_name": null,
                "twitter_name": null,
                "google_name": null,
                "linkedin_name": null,
                "instagram_name": null,
                "pinterest_name": null,
                "container_width": "850px",
                "container_text_align": "center",
                "body_background_colour": "#ffffff",
                "heading_text_colour": "#000000",
                "body_text_colour": "#333333",
                "border_colour": "#cccccc",
                "link_colour": "#2b68b6",
                "container_colour": "#ffffff",
                "button_colour": "#ffffff",
                "header_colour": "#FFFFFF",
                "error_colour": "#ED561B",
                "container_transparency": 0.8,
                "container_float": "center",
                "container_inner_width": "100%",
                "bg_dimension": "full",
                "words_position": "right",
                "logo_position": "left",
                "font_family": "\"Helvetica Neue\", Arial, Helvetica, sans-serif",
                "body_font_size": "12px",
                "heading_text_size": "18px",
                "heading_2_text_size": "12px",
                "heading_2_text_colour": "#000000",
                "heading_3_text_size": "12px",
                "heading_3_text_colour": "#000000",
                "btn_text": "Login Now",
                "btn_font_size": "18px",
                "btn_font_colour": "#000000",
                "welcome_text": null,
                "welcome_timeout": null,
                "show_welcome": false,
                "shop_active": true,
                "remove_registration_link": false,
                "newsletter_active": false,
                "newsletter_type": null,
                "newsletter_api_token": null,
                "newsletter_list_id": null,
                "forgot_password_link": true
            },
            "access_types": [
                {
                    "id": 1,
                    "name": "Password",
                    "description": null
                },
                {
                    "id": 2,
                    "name": "Vouchers",
                    "description": null
                },
                {
                    "id": 3,
                    "name": "Clickthrough",
                    "description": null
                },
                {
                    "id": 6,
                    "name": "Facebook",
                    "description": null
                },
                {
                    "id": 7,
                    "name": "Social",
                    "description": null
                }
            ],
            "networks": [
                {
                    "id": "54f22eeb4c697a2055030000",
                    "ssid": "Shit got real Wi-Fi"
                },
                {
                    "id": "54f225844c697a2055000000",
                    "ssid": "Shit got real Wi-Fi"
                },
                {
                    "id": "54efa7654c697a44b2030000",
                    "ssid": "Bridge"
                }
            ]
        }

### Update a splash page [PATCH]

Changes to the splash pages can be seen immediately. Changes to the speed limits, access types and white / blacklists require you to disconnect the end user first. If you want to add user to the blacklist, please update the splash page first then disconnect them using the Clients API. This way, they will be logged out and will not be able to login again.

+ Request (application/json)

    + Headers
    
            Accept: application/json

+ Response (application/json)

    + Body
    
        {
            "splash_page": {
                "unique_id": "36710012950163",
                "active": true,
                "location_id": 1813,
                "networks": [
                    "54efa7654c697a44b2030000"
                ],
                "primary_access_id": 1,
                "secondary_access": false,
                "secondary_access_id": null,
                "design_id": 1,
                "passwd_change_day": null,
                "passwd_auto_gen": false,
                "passwd_change_email": null,
                "success_url": null,
                "fb_use_ps": true,
                "fb_app_id": null,
                "fb_link": null,
                "fb_login_on": true,
                "g_login_on": true,
                "li_login_on": false,
                "li_api_key": null,
                "g_api_key": null,
                "g_use_ps": true,
                "g_page_id": null,
                "li_use_ps": true,
                "g_redirect_to_page": true,
                "fb_redirect_to_page": true,
                "fb_checkin": true,
                "backup_vouchers": false,
                "fb_page_id": null,
                "fb_msg": true,
                "access_restrict": "none",
                "access_restrict_period": "daily",
                "access_restrict_mins": 60,
                "access_restrict_down": 2048,
                "access_restrict_up": 1024,
                "whitelisted": null,
                "blacklisted": null,
                "available_days": null,
                "available_start": "00:00",
                "available_end": "00:00",
                "auto_login": false,
                "auto_login_timeout": 0,
                "skip_user_registration": false,
                "download_speed": 2048,
                "upload_speed": 1024,
                "session_timeout": 60,
                "idle_timeout": 60,
                "simultaneous_use": 25,
                "allow_registration": false,
                "password": "concerning",
                "weight": 100,
                "logo_file_name": null,
                "background_image_name": "https://d247kqobagyqjh.cloudfront.net/api/file/plDFnqvSKWHGn5i6zUqw",
                "location_image_name": null,
                "location_image_name_svg": null,
                "header_image_name": null,
                "header_image_name_svg": null,
                "header_image_type": 1,
                "header_text": "Welcome to Stuff got real",
                "info": "This is a generic page, get designing!",
                "info_two": null,
                "address": "12 Barry Lane",
                "error_message_text": null,
                "website": null,
                "facebook_name": null,
                "twitter_name": null,
                "google_name": null,
                "linkedin_name": null,
                "instagram_name": null,
                "pinterest_name": null,
                "container_width": "850px",
                "container_text_align": "center",
                "body_background_colour": "#ffffff",
                "heading_text_colour": "#000000",
                "body_text_colour": "#333333",
                "border_colour": "#cccccc",
                "link_colour": "#2b68b6",
                "container_colour": "#ffffff",
                "button_colour": "#ffffff",
                "header_colour": "#FFFFFF",
                "error_colour": "#ED561B",
                "container_transparency": 0.8,
                "container_float": "center",
                "container_inner_width": "100%",
                "bg_dimension": "full",
                "words_position": "right",
                "logo_position": "left",
                "font_family": "\"Helvetica Neue\", Arial, Helvetica, sans-serif",
                "body_font_size": "12px",
                "heading_text_size": "18px",
                "heading_2_text_size": "12px",
                "heading_2_text_colour": "#000000",
                "heading_3_text_size": "12px",
                "heading_3_text_colour": "#000000",
                "btn_text": "Login Now",
                "btn_font_size": "18px",
                "btn_font_colour": "#000000",
                "welcome_text": null,
                "welcome_timeout": null,
                "show_welcome": false,
                "shop_active": true,
                "remove_registration_link": false,
                "newsletter_active": false,
                "newsletter_type": null,
                "newsletter_api_token": null,
                "newsletter_list_id": null,
                "forgot_password_link": true
            },
            "access_types": [
                {
                    "id": 1,
                    "name": "Password",
                    "description": null
                },
                {
                    "id": 2,
                    "name": "Vouchers",
                    "description": null
                },
                {
                    "id": 3,
                    "name": "Clickthrough",
                    "description": null
                },
                {
                    "id": 6,
                    "name": "Facebook",
                    "description": null
                },
                {
                    "id": 7,
                    "name": "Social",
                    "description": null
                }
            ],
            "networks": [
                {
                    "id": "54f22eeb4c697a2055030000",
                    "ssid": "Shit got real Wi-Fi"
                },
                {
                    "id": "54f225844c697a2055000000",
                    "ssid": "Shit got real Wi-Fi"
                },
                {
                    "id": "54efa7654c697a44b2030000",
                    "ssid": "Bridge"
                }
            ]
        }

### Delete a splash page [DELETE]

Once you have done this, your users will no longer be able to view the page and will receive an error message instead unless you have created a new one. Users will NOT be disconnected and your boxes will not be synced.

+ Parameters

    + location_id (required, string, `le-gaff`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, string, `54f346f57261693b3d000000`) ... ID of the zone to perform action with. Has example value.

+ Request (application/json)

        {   
            "location_id": "le-gaff",
            "id": "54f346f57261693b3d000000",
        }

+ Response 204 (application/json)

# Group State Events

These represent the state changes of the boxes. You generally see these occuring each minute although you will see a record of the device being rebooted, installing etc.

Please note, these are not the actual device heartbeats.

State events are an ephemeral overview of what the box is doing.

They are a nested resource in the Boxes API.

##Allowed HTTPs requests:

- `GET` - Retrieves a resource or list of resources

## State Events Collection [/api/v1/boxes/{box_id}/state_events]

### List State Changes [GET]

+ Parameters

    + box_id (required, string, `JCyK7Zwh0ON_ZOWso8Mhuw`) ... Slug `slug` of the Box to perform action with. Has example value.

+ Response 200 (application/json)

    + Body
    
         
            [{
                "timestamp": 1412122931,
                "state": "rebooting"
            },
            {
                "timestamp": 1411696416,
                "state": "rebooting"
            },
            {
                "timestamp": 1411692346,
                "state": "rebooting"
            },
            {
                "timestamp": 1411691945,
                "state": "rebooting"
            },
            {
                "timestamp": 1411691880,
                "state": "rebooting"
            },
            {
                "timestamp": 1411691864,
                "state": "rebooting"
            },
            {
                "timestamp": 1411691783,
                "state": "rebooting"
            },
            {
                "timestamp": 1411691765,
                "state": "rebooting"
            },
            {
                "timestamp": 1411691722,
                "state": "rebooting"
            },
            {
                "timestamp": 1411685736,
                "state": "rebooting"
            },
            {
                "timestamp": 1411685633,
                "state": "online"
            },
            {
                "timestamp": 1411684031,
                "state": "online"
            }]


# Group StoreCarts

This end-point is specifically for use on the login screens. Creating a cart with a product is step one in the voucher purchase workflow.

StoreCarts are ephemeral and are removed after 3600 seconds.

Supports:

- `GET` - Retrieves a cart
- `POST` - Creates a cart
- `DELETE` - Deletes a cart

## Cart creation [/api/v1/store_carts{?store_id,product_ids}]

This will create a cart and add a product to it. It is not possible to create a cart without a product. If you send a null product_ids param to the API, the corresponding cart will be destroyed.

Use the POST end-point to both create the cart and also update products.

ProductIds must be ids from a Store's list of products. 

### Create and update a cart [POST]

+ Parameters

    + product_ids (required, array, `[123897128376123,827364876872364A]`) ... Send a list of products that you want to add to the cart
    + store_id (required, string, `your-store-id`) ... This is the id of the store you're attaching the transation id.

+ Response 200 (application/json)
    
    + Body


+ Parameters

# Group StoreOrders

This end-point is specifically for use on the login screens. Creating a cart with a product is step one in the voucher purchase workflow.

Notes about refunding


StoreCarts are ephemeral and are removed after 3600 seconds.

Supports:

- `GET` - Retrieves an order
- `PATCH` - Updates / refunds an order

## Cart creation [/api/v1/store_orders{?store_id,product_ids}]

This will create a cart and add a product to it. It is not possible to create a cart without a product. If you send a null product_ids param to the API, the corresponding cart will be destroyed.

Use the POST end-point to both create the cart and also update products.

ProductIds must be ids from a Store's list of products. 

### Create and update a cart [POST]

+ Parameters

    + product_ids (required, array, `[123897128376123,827364876872364A]`) ... Send a list of products that you want to add to the cart
    + store_id (required, string, `your-store-id`) ... This is the id of the store you're attaching the transation id.

+ Response 200 (application/json)
    
    + Body


+ Parameters

# Group Technologies

Represents the technologies API. An overview of the technologies in use across your network. Data derives currently from the login screens only.

##Allowed HTTPs requests:

- `GET` - Retrieves a resource or list of resources

## Technologies Collection [/api/v1/technologies{?q,start,end,page,size}]

A list of all the technologies in use on your networks. You may search by passing q=search_string. Results will be filtered accordingly.

Results are cached for ten minutes to improve load times.

### List technologies [GET]

+ Parameters

    + q (optional, string, `Search data`) ... Search through your list of tech..
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 12 weeks ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to now.
    + page (optional, integer, `1`) ... For pagination purposes. 
    + size (optional, integer, `500`) ... The number of records you want to return. Max. value is 1000.
    
+ Response 200 (application/json)
    
    + Body
    
            {
                "tech": [
                    {
                        "unique_id": null,
                        "request_uri": "polkaspots.my-wifi.co",
                        "request_ip": "10.227.57.10",
                        "request_os": "Mozilla/5.0 (iPhone; CPU iPhone OS 7_1 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Version/7.0 Mobile/11D167 Safari/9537.53",
                        "location_id": 870,
                        "created_at": "2014-05-09T13:06:09.000+01:00",
                        "platform": "iPhone",
                        "mobile": true,
                        "browser": "Safari",
                        "version": null,
                        "request_lat": 52.9235,
                        "request_lon": -1.47423,
                        "request_user": null
                    },
                    {
                        "unique_id": null,
                        "request_uri": "polkaspots.my-wifi.co",
                        "request_ip": "10.227.118.231",
                        "request_os": "Mozilla/5.0 (Linux; Android 4.4.2; C6903 Build/14.3.A.0.757) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.114 Mobile Safari/537.36",
                        "location_id": 870,
                        "created_at": "2014-05-09T12:52:03.000+01:00",
                        "platform": "Linux",
                        "mobile": true,
                        "browser": "Chrome",
                        "version": null,
                        "request_lat": 52.9235,
                        "request_lon": -1.47423,
                        "request_user": null
                    },
                    {
                        "unique_id": null,
                        "request_uri": "polkaspots.my-wifi.co",
                        "request_ip": "10.249.46.168",
                        "request_os": "Mozilla/5.0 (iPhone; CPU iPhone OS 7_0_4 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11B554a Safari/9537.53",
                        "location_id": 870,
                        "created_at": "2014-05-09T11:50:01.000+01:00",
                        "platform": "iPhone",
                        "mobile": true,
                        "browser": "Safari",
                        "version": null,
                        "request_lat": 52.9235,
                        "request_lon": -1.47423,
                        "request_user": null
                    },
                    {
                        "unique_id": null,
                        "request_uri": "polkaspots.my-wifi.co",
                        "request_ip": "10.65.17.122",
                        "request_os": "Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 620)",
                        "location_id": 870,
                        "created_at": "2014-05-09T11:23:44.000+01:00",
                        "platform": "Windows",
                        "mobile": true,
                        "browser": "Internet Explorer",
                        "version": null,
                        "request_lat": 52.9235,
                        "request_lon": -1.47423,
                        "request_user": null
                    }
                ],
                "_links": {
                    "current_page": 1,
                    "total_pages": 71,
                    "next_page": 2,
                    "total_entries": 1763
                }
            }

## Aggregations [/api/v1/technologies{?aggs,q,start,end}]

Get grouped / aggregated stats about the technologies in use in your networks.

### Technologies aggregrates [GET]

+ Parameters

    + aggs (required, boolean, `true`) ... Set this parameter to request aggregated tech. stats.
    + q (optional, string, `Search data`) ... Search through your list of tech..
    + start (optional, integer, `1406329200`) ... Start date for the query in Epoch / Unix format. Defaults to 12 weeks ago.
    + end (optional, integer, `1406329200`) ... End date for the query in Epoch / Unix format. Defaults to now.

+ Response 200 (application/json)
    
    + Body

            {
                "stats": {
                    "request_uri": {
                        "_type": "terms",
                        "missing": 0,
                        "total": 1763,
                        "other": 0,
                        "terms": [
                            {
                                "term": "polkaspots.my-wifi.co",
                                "count": 1538
                            },
                            {
                                "term": "polkaspots.wirelessisp.co",
                                "count": 225
                            }
                        ]
                    },
                    "request_ip": {
                        "_type": "terms",
                        "missing": 0,
                        "total": 1763,
                        "other": 583,
                        "terms": [
                            {
                                "term": "10.32.132.2",
                                "count": 160
                            },
                            {
                                "term": "10.17.133.179",
                                "count": 135
                            },
                            {
                                "term": "10.34.86.222",
                                "count": 130
                            },
                            {
                                "term": "10.5.17.12",
                                "count": 128
                            },
                            {
                                "term": "10.204.0.113",
                                "count": 127
                            },
                            {
                                "term": "10.32.40.97",
                                "count": 114
                            },
                            {
                                "term": "10.23.30.165",
                                "count": 112
                            },
                            {
                                "term": "26.27.49.254",
                                "count": 101
                            },
                            {
                                "term": "78.32.25.243",
                                "count": 87
                            },
                            {
                                "term": "10.32.42.110",
                                "count": 86
                            }
                        ]
                    },
                    "request_os": {
                        "_type": "terms",
                        "missing": 0,
                        "total": 29344,
                        "other": 15620,
                        "terms": [
                            {
                                "term": "mozilla",
                                "count": 1570
                            },
                            {
                                "term": "5.0",
                                "count": 1570
                            },
                            {
                                "term": "gecko",
                                "count": 1507
                            },
                            {
                                "term": "like",
                                "count": 1487
                            },
                            {
                                "term": "khtml",
                                "count": 1474
                            },
                            {
                                "term": "applewebkit",
                                "count": 1474
                            },
                            {
                                "term": "safari",
                                "count": 1451
                            },
                            {
                                "term": "mobile",
                                "count": 1312
                            },
                            {
                                "term": "version",
                                "count": 1112
                            },
                            {
                                "term": "os",
                                "count": 767
                            }
                        ]
                    },
                    "platform": {
                        "_type": "terms",
                        "missing": 240,
                        "total": 1523,
                        "other": 0,
                        "terms": [
                            {
                                "term": "iphone",
                                "count": 753
                            },
                            {
                                "term": "linux",
                                "count": 446
                            },
                            {
                                "term": "windows",
                                "count": 104
                            },
                            {
                                "term": "macintosh",
                                "count": 83
                            },
                            {
                                "term": "ipad",
                                "count": 62
                            },
                            {
                                "term": "blackberry",
                                "count": 58
                            },
                            {
                                "term": "x11",
                                "count": 12
                            },
                            {
                                "term": "android",
                                "count": 4
                            },
                            {
                                "term": "ipod",
                                "count": 1
                            }
                        ]
                    },
                    "browser": {
                        "_type": "terms",
                        "missing": 206,
                        "total": 1557,
                        "other": 5,
                        "terms": [
                            {
                                "term": "Safari",
                                "count": 829
                            },
                            {
                                "term": "Chrome",
                                "count": 337
                            },
                            {
                                "term": "Android",
                                "count": 205
                            },
                            {
                                "term": "Internet Explorer",
                                "count": 76
                            },
                            {
                                "term": "BlackBerry",
                                "count": 58
                            },
                            {
                                "term": "Firefox",
                                "count": 18
                            },
                            {
                                "term": "Microsoft",
                                "count": 13
                            },
                            {
                                "term": "uTorrent",
                                "count": 11
                            },
                            {
                                "term": "ocspd",
                                "count": 3
                            },
                            {
                                "term": "NAV",
                                "count": 2
                            }
                        ]
                    }
                }
            }

# Group Users

To view, update, modify your account information including billing, card details etc.

Currently we do not allow you to update your credit card details via the API. You can only do this via the CT main dashboard. Why? We use Stripe to process our payments and their JS api to process your card. Because of this, we do not see your credit card details - instead we exchange them for a token.

For more information about events, alerts and other things you can update via the Users API, please consult the standard documentation as this lists the rules and regulations, parameters and options in more detail.

You cannot delete your account.

- `GET` - Gets your account details
- `PATCH` - Updates a resource

## Account Details [/api/v1/me]

This is a handy end-point which is often required when using Oauth. It provides only some account information for yourself.

### Fetch high-level details [GET]

+ Response 200 (application/json)

    + Body
            {
                "email": "bob@marley.com",
                "username": "Big Chief",
                "accountId": "xxx",
                "createdAt": 1358467200000,
                "slug": "bob-marley",
                "key": "xxx",
                "gravatar": "xxx"
            }

## User Object [/api/v1/users/{id}]

You are only permitted to get your own account details and you will need the slug for your account. If you don't know this, use the /me/ end-point which will provide this for you.

Whilst we store the last4 numbers of your credit-card, we do not store the rest.

The user object contains details of your plan for good measure. 

You can pass a string of emails to the billing_email field. Doing so will send an email to each person.

If you want to cancel your account, you must use the Subscriptions API. You are unable to delete your account.

### Full user details [GET]

+ Parameters

    + id (required, string, `"bob-marley`) ... Slug `slug` for your account, bob-marley.

+ Response 200 (application/json)

    + Body
            {
                "username": "Big Chief",
                "email": "bob@marley.com",
                "company_name": "PolkaSpots Limted",
                "mobile_number": "0777777777",
                "timezone": "London",
                "country": "United Kingdom",
                "account_id": "AXXXXX",
                "last_sign_in_at": "2015-02-28T14:35:16.000+00:00",
                "last_sign_in_ip": "42.26.113.177",
                "plan": {
                    "plan_name": "Uncle Tony",
                    "plan_description": "For hotels, offices and small franchises",
                    "location_count": 30,
                    "hotspot_count": 30,
                    "voucher_count": 5000,
                    "email_support": true,
                    "phone_support": false,
                    "billing_period": "monthly",
                    "daily_sessions": 1000,
                    "shop_allowed": false,
                    "enterprise_plan": false,
                    "max_location_users": 5,
                    "plan_price": "36.0",
                    "max_networks": 2,
                    "id": null
                },
                "slug": "bob-marley",
                "credit_card_last4": null,
                "credit_card_type": null,
                "credit_card_country": "UK",
                "credit_card_expiry": "",
                "billing_email": null,
                "billing_address": null,
                "billing_city": null,
                "billing_postcode": null,
                "billing_name": null,
                "tax_rate": "20.0",
                "subscribing": false,
                "cancelling": false,
                "alerts": true,
                "alerts_window_start": "400",
                "alerts_window_end": "2330",
                "alerts_window_days": [
                    "5",
                    "6"
                ],
                "max_daily_state_events": 10,
                "admin_users": 5,
                "invites_remaining": 5,
                "referral_url": "http://bit.ly/xx",
                "stripe_id": "123"
            }

### Update your account [PATCH]

+ Parameters

    + id (required, string, `bob-marley`) ... Slug `slug` for your account, bob-marley.

+ Request (application/json)
    
        { 
            "user_id": "simon-morley"
            "user":
                {
                    "current_password": "your-current-secure-passy",
                    "password": "JCyK7Zwh0ON_ZOWso8Mhuw"
                }

        }

+ Response 200 (application/json)

    +    body 

            { "message" : "Success!" }


## Update your password [/api/v1/users/{id}/password{?user}]

### Update your password [PATCH]

+ Parameters

    + id (required, string, `"bob-marley`) ... Slug `slug` for your account, simon-the-morley.

+ Request (application/json)
    
        { 
            "user_id": "bob-marley"
            "user":
                {
                    "current_password": "your-current-secure-passy",
                    "password": "JCyK7Zwh0ON_ZOWso8Mhuw"
                }

        }

+ Response 200 (application/json)

    +    body 

            { "message" : "Success!" }

## View usage quotas [/api/v1/users/{id}/quotas]

If you want to see your current usage, including the splash page views or number of locations. You can use this API. 

Splash Page view are currently updated nightly.

### View you usage quotas [GET]

+ Parameters

    + id (required, string, `"bob-marley`) ... Slug `slug` for your account, simon-the-morley.

+ Request (application/json)
    
        { 
            "id": "bob-marley"
        }

+ Response 200 (application/json)

    +    body 

            {
                "quota": {
                    "locations": 100,
                    "admins": 5,
                    "boxes": 100,
                    "vouchers": 5000,
                    "splash_views": 150,
                    "free": false
                },
                "usage": {
                    "locations": 10,
                    "admins": 0,
                    "boxes": 52,
                    "splash_views": 1164
                }
            }

## Logout all sessions [/api/v1/users/{id}/logout_all]

For security reasons, we will allow you to destroy all current sessions using your account. You might like to use this if you've lost your phone etc.

Even your current session will be destroyed.

### Logout all sessions [POST]

+ Parameters

    + id (required, string, `"bob-marley`) ... Slug `slug` for your account, simon-the-morley.

+ Request (application/json)
    
        { 
            "id": "bob-marley"
        }

+ Response 200 (application/json)

    +    body 

            {
                "message": "Ok"
            }

# Group Webhooks

Webhooks are a beta feature and will not work on all accounts yet. Webhooks will notify your own application when an event is triggered. 

For example, CT can notify you when a user signs in or when an invitation is accepted.

We will post the data to you as JSON and expect an HTTPS, encrypted end-point. If you're not using SSL, well, shame on you.

## Webhooks Collection [/api/v1/webhooks]

+ Response 200 (application/json)
            
    + Body
            [
                {
                    "user_id": 1,
                    "id": "54f35b034c697a9f2e020000",
                    "url": "https://polkaspots.com/callback.json",
                    "updated_at": 1425234691,
                    "alerting": null,
                    "alert_count": null,
                    "disabled": false,
                    "box": {
                        "created": true,
                        "offline": true,
                        "online": true,
                        "reset": true,
                        "transferred": true,
                        "removed": true,
                        "rebooted": true,
                        "upgraded": true
                    },
                    "admin": {
                        "created": true,
                        "removed": true,
                        "accepted": true
                    },
                    "sub": {
                        "created": true,
                        "invoice": true,
                        "cancel": true,
                        "updated": true,
                        "card": true,
                        "failed": true
                    },
                    "venue": {
                        "created": true,
                        "transferred": true,
                        "duplicated": true,
                        "new_client": true,
                        "new_guest": true,
                        "new_email": true,
                        "blocked_user": true
                    }
                }
            ]

### Create a new webhook [POST]

You must send a valid url - including https.

+ Request (application/json)

        {
            "url": "https://polkaspots.com/fancy-webhook",
            "box": {
                "created": true,
                "offline": false,
                "online": false,
                "reset": true,
                "transferred": true,
                "removed": true,
                "rebooted": true,
                "upgraded": true
            },
            "admin": {
                "created": true,
                "removed": true,
                "accepted": true
            },
            "sub": {
                "created": false,
                "invoice": true,
                "cancel": false,
                "updated": true,
                "card": true,
                "failed": true
            },
            "venue": {
                "created": false,
                "transferred": false,
                "duplicated": true,
                "new_client": true,
                "new_guest": true,
                "new_email": true,
                "blocked_user": true
            }
        }

+ Response 200 (application/json)
        
        {
            "user_id": 1,
            "id": "54da01fa49726f70e8500000",
            "url": "https://polkaspots.com/fancy-webhook",
            "updated_at": 1423586447,
            "alerting": null,
            "alert_count": null,
            "disabled": false,
            "box": {
                "created": true,
                "offline": false,
                "online": false,
                "reset": true,
                "transferred": true,
                "removed": true,
                "rebooted": true,
                "upgraded": true
            },
            "admin": {
                "created": true,
                "removed": true,
                "accepted": true
            },
            "sub": {
                "created": false,
                "invoice": true,
                "cancel": false,
                "updated": true,
                "card": true,
                "failed": true
            },
            "venue": {
                "created": false,
                "transferred": false,
                "duplicated": true,
                "new_client": true,
                "new_guest": true,
                "new_email": true,
                "blocked_user": true
            }
        }

## Webhook item [/api/v1/webhooks/{id}]

### Display a specific webhook [GET]

+ Parameters

    + id (required, string, `54da01fa49726f70e8500000`) ... ID of the webhook 


+ Request (application/json)

        {   
            "id": "54da01fa49726f70e8500000",
        }

+ Response 200 (application/json)
        
        {
            "user_id": 1,
            "id": "54da01fa49726f70e8500000",
            "url": "https://polkaspots.com/fancy-webhook",
            "updated_at": 1423586447,
            "alerting": null,
            "alert_count": null,
            "disabled": false,
            "box": {
                "created": true,
                "offline": false,
                "online": false,
                "reset": true,
                "transferred": true,
                "removed": true,
                "rebooted": true,
                "upgraded": true
            },
            "admin": {
                "created": true,
                "removed": true,
                "accepted": true
            },
            "sub": {
                "created": false,
                "invoice": true,
                "cancel": false,
                "updated": true,
                "card": true,
                "failed": true
            },
            "venue": {
                "created": false,
                "transferred": false,
                "duplicated": true,
                "new_client": true,
                "new_guest": true,
                "new_email": true,
                "blocked_user": true
            }
        }

### Update a specific webhook [PATCH]

+ Parameters

    + id (required, string, `54da01fa49726f70e8500000`) ... ID of the webhook 


+ Request (application/json)

        {   
            "id": "54da01fa49726f70e8500000",
            "webhook": {
                "url": "https://polkaspots.com/new-webhook",
                "box": {
                    "created": true,
                    "offline": false,
                    "online": false,
                    "reset": true,
                    "transferred": true,
                    "removed": true,
                    "rebooted": true,
                    "upgraded": true
                }
            }
        }

+ Response 200 (application/json)
        
        {
            "user_id": 1,
            "id": "54da01fa49726f70e8500000",
            "url": "https://polkaspots.com/new-webhook",
            "updated_at": 1423586447,
            "alerting": null,
            "alert_count": null,
            "disabled": false,
            "box": {
                "created": true,
                "offline": false,
                "online": false,
                "reset": true,
                "transferred": true,
                "removed": true,
                "rebooted": true,
                "upgraded": true
            },
            "admin": {
                "created": true,
                "removed": true,
                "accepted": true
            },
            "sub": {
                "created": false,
                "invoice": true,
                "cancel": false,
                "updated": true,
                "card": true,
                "failed": true
            },
            "venue": {
                "created": false,
                "transferred": false,
                "duplicated": true,
                "new_client": true,
                "new_guest": true,
                "new_email": true,
                "blocked_user": true
            }
        }

### Delete a specific webhook [DELETE]

+ Parameters

    + id (required, string, `54da01fa49726f70e8500000`) ... ID of the webhook 


+ Request (application/json)

        {   
            "id": "54da01fa49726f70e8500000",
        }

+ Response (application/json)

        { message: true }

# Group Zones

Zones allow you to offer different SSIDs (networks), on different boxes. For example, you can offer a public SSID on your lobby boxes and then add a private SSID if the box is installed in your office.

Moreover, you can even offer different splash pages per zone. This allows you to offer different types of access in different areas. For example, you might want to offer clickthrough access to guests in the lobby and voucher access upstairs. Consult the Splash Page API for more information.

You can create up to 16 zones per location.

As soon as you've created a zone, splash users will not able to see the splash pages until you have added the boxes in correctly.

You need to resync the networks in order for the changes to propagate to the boxes.

## Zones Collection [/api/v1/locations/{location_id}/zones{?boxes,zones}]

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + boxes (required, array, `1,2,3`) ... An array of boxes you want to add to the zone
    + networks (required, array, `1,2,3`) ... An array of networks you want to add to the zone

### List all Zones [GET]

+ Request (application/json)

    + Headers
    
            Accept: application/json

+ Response (application/json)

    + Body
    
            [
                {
                    "zone_name": "Lobby, secure LAN",
                    "zone_description": null,
                    "id": "54f346f57261693b3d000000",
                    "created_at": 1425229557
                },
                {
                    "zone_name": "Reception",
                    "zone_description": null,
                    "id": "54f346fe7261693b3d010000",
                    "created_at": 1425229566
                }
            ]

### Create new zone [POST]

When you're creating a zone, you can choose to add networks and boxes. If you don't send either a boxes or network object with an array of ids, we will create an empty zone. You can then add to it later.

+ Request (application/json)

    + Headers
    
            Accept: application/json
            
    + Body
    
            { 
                location_id: 'derby-city-council',
                zone: {
                        boxes: [1,2,3],
                        networks: ['44f228d17261690826000000'],
                        zone_name: 'Lobby, secure LAN',
                        zone_description: 'In the cupboard'
                    }
            }
            

+ Response (application/json)

    + Body   

            {
                "zone": {
                    "id": "54f346f57261693b3d000000",
                    "zone_name": "Lobby, secure LAN",
                    "zone_description": "In the cupboard",
                    "created_at": 1425229557
                },
                "networks": [
                    {
                        "network_id": "44f228d17261690826000000",
                        "description": "Le Gaff Wi-Fi"
                    }
                ],
                "boxes": [
                    {
                        "box_id": 3182,
                        "mac": "xx-xx-0A-33-2E-xx"
                    },
                    {
                        "box_id": 3167,
                        "mac": "xx-A4-3C-7C-FC-xx"
                    }
                ]
            }
        
        
## Zones Object [/api/v1/locations/{location_id}/zones/{id}]

+ Parameters

    + location_id (required, string, `derby-city-council`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, string, `54f346f57261693b3d000000`) ... ID of the Zone to perform action with. Has example value.

### Viewing a zone [GET]

+ Request (application/json)

    + Headers
    
            Accept: application/json
            
    + Body
    
            { 
                location_id: 'derby-city-council',
                id: '54f346f57261693b3d000000'
            }
                

+ Response (application/json)

   + Body   

            {
                "zone": {
                    "id": "54f346f57261693b3d000000",
                    "zone_name": "Lobby, secure LAN",
                    "zone_description": "In the cupboard",
                    "created_at": 1425229557
                },
                "networks": [
                    {
                        "network_id": "44f228d17261690826000000",
                        "description": "Le Gaff Wi-Fi"
                    }
                ],
                "boxes": [
                    {
                        "box_id": 3182,
                        "mac": "xx-xx-0A-33-2E-xx"
                    },
                    {
                        "box_id": 3167,
                        "mac": "xx-A4-3C-7C-FC-xx"
                    }
                ]
            }

### Updating a zone [PATCH]

When you update a zone, ensure you pass the box and network ids in to the zone object as below. If you pass an empty object, we will assume you want to remove the boxes / networks from the zone.

If you just want to update the name, do not send the zones / boxes params.

+ Request (application/json)

    + Headers
    
            Accept: application/json
            
    + Body
    
            { 
                location_id: 'derby-city-council',
                id: '54f346f57261693b3d000000',
                zone:
                    
                    {
                        boxes: [1,2,3],
                        networks: ['44f228d17261690826000000'],
                        zone_name: 'Lobby, secure LAN',
                        zone_description: 'In the cupboard'
                    }
            }
                
+ Response (application/json)

   + Body   

            {
                "zone": {
                    "id": "54f346f57261693b3d000000",
                    "zone_name": "Lobby, secure LAN",
                    "zone_description": "In the cupboard",
                    "created_at": 1425229557
                },
                "networks": [
                    {
                        "network_id": "44f228d17261690826000000",
                        "description": "Le Gaff Wi-Fi"
                    }
                ],
                "boxes": [
                    {
                        "box_id": 3182,
                        "mac": "xx-xx-0A-33-2E-xx"
                    },
                    {
                        "box_id": 3167,
                        "mac": "xx-xx-3C-7C-FC-xx"
                    }
                ]
            }

### Delete a zone [DELETE]

+ Parameters

    + location_id (required, string, `le-gaff`) ... Slug `slug` of the Location to perform action with. Has example value.
    + id (required, string, `54f346f57261693b3d000000`) ... ID of the zone to perform action with. Has example value.

+ Request (application/json)

        {   
            "location_id": "le-gaff",
            "id": "54f346f57261693b3d000000",
        }

+ Response 204 (application/json)

# Group Miscellaneous

Accounts related resources of the **Accounts API**

## Accounts Collection [/api/v1/accounts]

## Generate Password [/accounts/generate_password]

Create a unique password for your captive portal. This doesn't save anything, it's just a nice little end-point to use.

### Generate a one time password [POST]

+ Request (application/json)

            Accept: application/json

+ Response 200 (application/json)

    + Body

            {"password": "random-passy"}
